# reMarkable Paper Pro Move å¾®ä¿¡è¯»ä¹¦åº”ç”¨å¼€å‘æŒ‡å—

> **ğŸš€ å¿«é€Ÿå¼€å§‹**: å¦‚æœä½ åªæƒ³å®‰è£…ä½¿ç”¨ï¼Œè¯·æŸ¥çœ‹ **[QUICKSTART.md](QUICKSTART.md)** è·å–ç®€æ´çš„å®‰è£…éƒ¨ç½²æŒ‡å¼•ã€‚
> 
> æœ¬æ–‡æ¡£æ˜¯å®Œæ•´çš„æŠ€æœ¯æ–‡æ¡£ï¼ŒåŒ…å«æ¶æ„è®¾è®¡ã€æ–¹æ¡ˆå¯¹æ¯”ã€é£é™©è¯„ä¼°ç­‰è¯¦ç»†å†…å®¹ï¼Œé€‚åˆå¼€å‘è€…æ·±å…¥äº†è§£é¡¹ç›®ã€‚

---

## ğŸ“‹ æ‰§è¡Œæ‘˜è¦ï¼ˆ2025å¹´11æœˆæ›´æ–° - Phase B å¯åŠ¨ï¼‰

> **TL;DR**: Phase A å·²åœ¨å®ä½“è®¾å¤‡ä¸Šç¡®è®¤**ç³»ç»Ÿè‡ªå¸¦ Qt6.8.2 + epaper æ¸²æŸ“é“¾è·¯å®Œå…¨å¯ç”¨**ï¼Œå±å¹•æ˜¾ç¤ºã€è§¦æ§è¾“å…¥åŠ QML å¼•æ“å…¨éƒ¨é€šè¿‡éªŒè¯ã€‚Phase B çš„é¦–è¦ç›®æ ‡æ˜¯**è¡¥é½ Qt6 WebEngine ç»„ä»¶**ï¼Œåœ¨åŸç”Ÿ Qt6 ç¯å¢ƒä¸‹è·‘é€šå¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆï¼›Qt5 è¿è¡Œæ—¶éƒ¨ç½²æ–¹æ¡ˆä¿ç•™ä¸ºå¤‡ç”¨è·¯å¾„ã€‚[Oxide æµè§ˆå™¨é¡¹ç›®](https://github.com/Eeems/oxide)ä¸æˆ‘ä»¬æœ€æ–°å®æµ‹å‡è¡¨æ˜ Qt WebEngine åœ¨ reMarkable ä¸Šæ€§èƒ½å¯æ§ã€‚

### æ ¸å¿ƒç»“è®º

| æŒ‡æ ‡ | ç»“è®º |
|------|------|
| **é¡¹ç›®å¯è¡Œæ€§** | âœ… **é«˜åº¦å¯è¡Œ** - æœ‰æˆåŠŸæ¡ˆä¾‹å’Œå®æµ‹æ•°æ®æ”¯æ’‘ |
| **æ¨èæ–¹æ¡ˆ** | ğŸ† **Qt WebEngine** (ç½®ä¿¡åº¦90%) |
| **å¼€å‘å‘¨æœŸ** | â±ï¸ **4-6å‘¨** (å«éªŒè¯ã€å¼€å‘ã€æµ‹è¯•ã€å‘å¸ƒ) |
| **æŠ€æœ¯éš¾åº¦** | ğŸŸ¡ **ä¸­ç­‰** - å¯å¤ç”¨Oxideä»£ç ï¼Œæœ‰ä¸°å¯Œå‚è€ƒ |
| **èµ„æºå ç”¨** | ğŸŸ¢ **å¯æ¥å—** - 120-180MBå†…å­˜ï¼Œç¬¦åˆè®¾å¤‡èƒ½åŠ› |
| **é£é™©è¯„çº§** | ğŸŸ¡ **ä¸­ç­‰** - ä¸»è¦é£é™©å¯æ§ï¼Œæœ‰ç¼“è§£æªæ–½ |

### å…³é”®å‘ç°ï¼ˆPhase A â†’ Phase Bï¼‰

1. **Phase A å®æµ‹é€šè¿‡**ï¼šç³»ç»Ÿ Qt6.8.2 + epaper æ’ä»¶å·²éªŒè¯æ¸²æŸ“ã€è¾“å…¥ã€QML å…¨é“¾è·¯å¯ç”¨ï¼Œè¯æ˜æ— éœ€è‡ªå»º Qt åŸºç¡€æ ˆã€‚
2. **Qt6 WebEngine æˆä¸ºç“¶é¢ˆ**ï¼šç³»ç»Ÿç¼ºå°‘ Qt6WebEngineï¼Œéœ€è¦åœ¨ Phase B ä¸­è‡ªè¡Œç¼–è¯‘æˆ–ç§»æ¤ç›¸åŒç‰ˆæœ¬ç»„ä»¶ã€‚
3. **ç©ºé—´ä¸æ€§èƒ½å†—ä½™**ï¼šè®¾å¤‡/home ç›®å½•å‰©ä½™ **45.6GB**ï¼Œå†…å­˜/CPU ä¹Ÿèƒ½æ»¡è¶³ Qt WebEngineï¼ˆ120-180MB å†…å­˜ã€4-6 ç§’å¯åŠ¨ï¼‰çš„éœ€æ±‚ã€‚
4. **Qt5/Qt6 å…±å­˜ç­–ç•¥æœ‰æ•ˆ**ï¼šè‹¥ Qt6 WebEngine ç¼–è¯‘å—é˜»ï¼Œå¯å›é€€åˆ°ç‹¬ç«‹ Qt5 è¿è¡Œæ—¶ï¼ŒäºŒè€…é€šè¿‡ç¯å¢ƒå˜é‡å®ç°éš”ç¦»ã€‚
5. **Lightpanda ä»éœ€è§‚å¯Ÿ**ï¼šä»…æä¾›æ— å¤´ CDP èƒ½åŠ›ï¼ŒçŸ­æœŸå†…ä¸ä½œä¸º ä¸»è·¯å¾„ã€‚

### ç«‹å³è¡ŒåŠ¨ï¼ˆPhase B Sprint 0ï¼‰

```bash
# ç¬¬0æ­¥ï¼šå¤ç° Phase A ç¯å¢ƒ
git pull && git submodule update --init
ssh root@10.11.99.1 "systemctl stop xochitl"  # éœ€è¦æ—¶é‡Šæ”¾epaper

# ç¬¬1æ­¥ï¼šæ­å»º Qt6.8.2 WebEngine äº¤å‰ç¼–è¯‘ç¯å¢ƒ
wget https://remarkable.engineering/oecore-x86_64-cortexa53-toolchain-3.1.15.sh
chmod +x oecore-x86_64-cortexa53-toolchain-3.1.15.sh
sudo ./oecore-x86_64-cortexa53-toolchain-3.1.15.sh
source /opt/oecore*/environment-setup-cortexa53-remarkable-linux

# ç¬¬2æ­¥ï¼šè·å– Qt æºç å¹¶é…ç½®è½»é‡åŒ– WebEngine
wget https://download.qt.io/official_releases/qt/6.8/6.8.2/single/qt-everywhere-src-6.8.2.tar.xz
tar xf qt-everywhere-src-6.8.2.tar.xz && cd qt-everywhere-src-6.8.2
./configure \
  -release -opensource -confirm-license \
  -prefix /opt/remarkable/qt6 \
  -sysroot $SDKTARGETSYSROOT \
  -device linux-remarkable-g++ \
  -skip qt3d -skip qtquick3d -skip qtmultimedia -skip qtwaylandcompositor \
  -no-opengl -no-gtk -no-dbus \
  -webengine-proprietary-codecs -no-webengine-webrtc -no-feature-webengine-printing
cmake --build . --parallel && cmake --install .

# ç¬¬3æ­¥ï¼šéƒ¨ç½²æœ€å° WebEngine æ ·ä¾‹éªŒè¯ Qt6 + epaper
cd /path/to/src
./scripts/build-qt6-webengine.sh
./scripts/deploy-qt6-webengine.sh 10.11.99.1
ssh root@10.11.99.1 "/home/root/weread-app/bin/weread-qt6 --test-url https://weread.qq.com"

# ç¬¬4æ­¥ï¼šè®°å½• Phase B åŸºçº¿æ•°æ®ï¼ˆå†…å­˜/å¸§åˆ·æ–°/è¾“å…¥ï¼‰
ssh root@10.11.99.1 "free -h && top -b -n1 | grep weread-qt6"
```

> è¯´æ˜ï¼šè‹¥ Qt6 WebEngine ç¼–è¯‘ä¸å¯è¡Œï¼Œå¯å¿«é€Ÿåˆ‡æ¢åˆ° Qt5 è¿è¡Œæ—¶éƒ¨ç½²æ–¹æ¡ˆï¼ˆè§é™„å½• Bï¼‰ä½œä¸ºé™çº§è·¯å¾„ã€‚

### æ–‡æ¡£æ›´æ–°å†…å®¹

- âœ… æ·»åŠ äº†è¯¦ç»†çš„æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µï¼ˆç¬¬3ç« ï¼‰
- âœ… é‡æ–°è¯„ä¼°Qt WebEngineï¼Œçº æ­£è¯¯åˆ¤ï¼ˆç¬¬3.2ç« ï¼‰
- âœ… æä¾›å®Œæ•´çš„å®ç°ä»£ç å’Œç¼–è¯‘æŒ‡å—ï¼ˆç¬¬4ç« ï¼‰
- âœ… æ·±åº¦è°ƒç ”ç¤¾åŒºèµ„æºå’ŒOxideé¡¹ç›®ï¼ˆç¬¬7ç« ï¼‰
- âœ… é‡å†™é£é™©è¯„ä¼°å’Œåº”å¯¹ç­–ç•¥ï¼ˆç¬¬5ç« ï¼‰
- âœ… æ›´æ–°ç»“è®ºå’Œç«‹å³è¡ŒåŠ¨è®¡åˆ’ï¼ˆç¬¬8ç« ï¼‰
- âœ… **å®æµ‹éªŒè¯**ï¼šç¡®è®¤/homeç©ºé—´å……è¶³ï¼ŒQt5/Qt6å¯å…±å­˜ï¼ˆREVISED_QT_SOLUTION.mdï¼‰
- âœ… æ¶æ„ä¿®æ­£ï¼šARMv7â†’ARMv8ï¼ŒDockerç¼–è¯‘æ–¹æ¡ˆï¼ˆè§CHANGELOG.mdï¼‰

---

## é¡¹ç›®æ¦‚è¿°

æœ¬é¡¹ç›®æ—¨åœ¨ä¸ºreMarkable Paper Pro Moveè®¾å¤‡å¼€å‘ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œå®ç°è®¿é—®å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆ(r.qq.com)çš„åŠŸèƒ½ï¼Œå¹¶é€šè¿‡æ‰‹å†™ç¬”å®ç°ç¿»é¡µã€ç‚¹å‡»ç­‰åŸºæœ¬æ“ä½œã€‚

## 1. è®¾å¤‡æ¦‚è¿°

### 1.1 reMarkable Paper Pro MoveæŠ€æœ¯è§„æ ¼
- **æ˜¾ç¤º**: 7.3è‹±å¯¸å½©è‰²ç”µå­å¢¨æ°´å± (300 PPI) <mcreference link="http://m.toutiao.com/group/7545865078727148082/" index="1">1</mcreference>
- **å¤„ç†å™¨**: 1.7GHzåŒæ ¸å¤„ç†å™¨ <mcreference link="http://m.toutiao.com/group/7545865078727148082/" index="1">1</mcreference>
- **å†…å­˜**: 8GBå­˜å‚¨ç©ºé—´
- **æ“ä½œç³»ç»Ÿ**: Codex (åŸºäºLinuxçš„å®šåˆ¶ç³»ç»Ÿ)
- **è¿æ¥æ€§**: Wi-Fi, USB-C
- **è¾“å…¥**: ç”µç£ç¬”+è§¦æ‘¸æ”¯æŒ
- **ç”µæ± **: æä¾›ä¸¤å‘¨ç»­èˆªæ—¶é—´ <mcreference link="http://m.toutiao.com/group/7545865078727148082/" index="1">1</mcreference>

### 1.2 è®¾å¤‡ç‰¹ç‚¹
- ä¾¿æºå¼è®¾è®¡ï¼Œä¸“ä¸ºç§»åŠ¨ç”¨æˆ·è®¾è®¡ <mcreference link="http://m.toutiao.com/group/7545865078727148082/" index="1">1</mcreference>
- é€‚åˆç«™ç«‹æ—¶å•æ‰‹æ“ä½œ <mcreference link="http://m.toutiao.com/group/7545865078727148082/" index="1">1</mcreference>
- èƒŒé¢è®¾è®¡é«˜æ‘©æ“¦è¡¨é¢ä»¥å¢å¼ºæ¡æŒæ„Ÿ <mcreference link="http://m.toutiao.com/group/7545865078727148082/" index="1">1</mcreference>
- ä½å»¶è¿Ÿä¹¦å†™ä½“éªŒ
- æŠ¤çœ¼ç”µå­å¢¨æ°´å±
- é•¿ç»­èˆªèƒ½åŠ›
- ä¸“æ³¨é˜…è¯»ä½“éªŒ

## 2. æŠ€æœ¯æ–¹æ¡ˆåˆ†æ

### 2.1 å¯è¡Œæ€§è¯„ä¼°

#### ä¼˜åŠ¿
1. **æ“ä½œç³»ç»ŸåŸºç¡€**: reMarkableè¿è¡ŒåŸºäºLinuxçš„Codexç³»ç»Ÿï¼Œæ”¯æŒä¸€å®šç¨‹åº¦çš„å®šåˆ¶å¼€å‘
2. **ç¡¬ä»¶èƒ½åŠ›**: è®¾å¤‡å…·å¤‡å¤„ç†ç½‘é¡µæ¸²æŸ“å’Œè§¦æ‘¸è¾“å…¥çš„åŸºæœ¬èƒ½åŠ›
3. **ç¤¾åŒºæ”¯æŒ**: å­˜åœ¨æ´»è·ƒçš„å¼€å‘ç¤¾åŒºï¼Œæä¾›äº†ä¸€äº›å¼€å‘å·¥å…·å’ŒAPI

#### æŒ‘æˆ˜
1. **æ¸²æŸ“é™åˆ¶**: ç”µå­å¢¨æ°´å±çš„åˆ·æ–°ç‡é™åˆ¶å¯èƒ½å½±å“ç½‘é¡µæµè§ˆä½“éªŒ
2. **è‰²å½©æ”¯æŒ**: è™½ç„¶æ˜¯å½©è‰²å¢¨æ°´å±ï¼Œä½†è‰²å½©è¡¨ç°åŠ›æœ‰é™
3. **ç³»ç»Ÿé™åˆ¶**: Codexç³»ç»Ÿè¾ƒä¸ºå°é—­ï¼Œç›´æ¥å¼€å‘åº”ç”¨æœ‰ä¸€å®šéš¾åº¦
4. **æ€§èƒ½é™åˆ¶**: å¤„ç†å™¨æ€§èƒ½æœ‰é™ï¼Œå¯èƒ½å½±å“å¤æ‚ç½‘é¡µçš„æ¸²æŸ“

#### ç¦»çº¿ä½¿ç”¨è€ƒè™‘
1. **æœ¬åœ°æµè§ˆå™¨æ–¹æ¡ˆ**: å¯ä»¥ç¼“å­˜éƒ¨åˆ†å†…å®¹ï¼Œæä¾›æœ‰é™çš„ç¦»çº¿é˜…è¯»èƒ½åŠ›
2. **ä¼˜åŒ–ç­–ç•¥**: é€šè¿‡æ™ºèƒ½ç¼“å­˜å’Œé¢„åŠ è½½ï¼Œå¢å¼ºç¦»çº¿ä½“éªŒ

### 2.2 å¼€å‘æ–¹æ¡ˆ

#### æ–¹æ¡ˆä¸€: åŸºäºç°æœ‰æµè§ˆå™¨å¼•æ“çš„å®šåˆ¶åº”ç”¨
1. **æŠ€æœ¯æ ˆ**:
   - ä½¿ç”¨Qt WebEngineæˆ–ç±»ä¼¼è½»é‡çº§æµè§ˆå™¨å¼•æ“
   - C++/Qtå¼€å‘åº”ç”¨æ¡†æ¶
   - è‡ªå®šä¹‰è§¦æ‘¸å’Œæ‰‹å†™ç¬”è¾“å…¥å¤„ç†

2. **å®ç°æ­¥éª¤**:
   - ç ”ç©¶reMarkableå¼€å‘ç¯å¢ƒå’ŒSDK
   - ç§»æ¤è½»é‡çº§æµè§ˆå™¨å¼•æ“åˆ°è®¾å¤‡
   - å¼€å‘è‡ªå®šä¹‰UIæ¡†æ¶é€‚é…ç”µå­å¢¨æ°´å±
   - å®ç°æ‰‹å†™ç¬”æ‰‹åŠ¿è¯†åˆ«å’Œäº¤äº’é€»è¾‘
   - ä¼˜åŒ–ç½‘é¡µæ¸²æŸ“ä»¥é€‚åº”ç”µå­å¢¨æ°´å±ç‰¹æ€§
   - å®ç°æ™ºèƒ½ç¼“å­˜ç³»ç»Ÿï¼Œæ”¯æŒç¦»çº¿é˜…è¯»

3. **NetSurfå®ç°æ¡ˆä¾‹**:
   - **å·²éªŒè¯æ–¹æ¡ˆ**: NetSurfæµè§ˆå™¨å·²æˆåŠŸåœ¨reMarkable Paper Proä¸Šè¿è¡Œ
   - **ä¼˜åŠ¿**: è½»é‡çº§(çº¦9.2MB)ï¼Œå¯åŠ¨å¿«(2-3ç§’)ï¼Œå†…å­˜å ç”¨ä½(çº¦50-100MB)
   - **å½“å‰é™åˆ¶**: JavaScriptæ”¯æŒä¸å®Œæ•´ï¼Œæ— æ³•æ˜¾ç¤ºç™»å½•äºŒç»´ç å’Œéƒ¨åˆ†ä¹¦ç±å†…å®¹
   - **é…ç½®ç¤ºä¾‹**:
     ```ini
     # NetSurfé…ç½® (/home/root/.netsurf/Choices)
     homepage_url: https://weread.qq.com/web/shelf
     scale:120               # 120% ç¼©æ”¾
     enable_javascript:1     # å¯ç”¨JavaScript
     fb_toolbar_size:60      # å·¥å…·æ é«˜åº¦
     fb_osk:1                # å¯ç”¨è™šæ‹Ÿé”®ç›˜
     # ä¸­æ–‡å­—ä½“é…ç½®
     fb_face_sans_serif:/opt/share/fonts/noto-cjk/NotoSansCJK-Regular.ttc
     ```
   - **è¾“å…¥æ”¯æŒ**: ç¬”è¾“å…¥ã€æ‰‹æŒ‡è§¦æ‘¸ã€ç‰©ç†æŒ‰é”®ã€è™šæ‹Ÿé”®ç›˜å‡å·²å¯ç”¨
   - **è§£å†³æ–¹æ¡ˆ**: é’ˆå¯¹JavaScriptæ”¯æŒé—®é¢˜ï¼Œå¯è€ƒè™‘ä»¥ä¸‹æ”¹è¿›æ–¹å‘:
     - é›†æˆæ›´å®Œæ•´çš„JavaScriptå¼•æ“
     - å®ç°å¾®ä¿¡è¯»ä¹¦APIçš„ç›´æ¥è°ƒç”¨
     - å¼€å‘æ··åˆæ¸²æŸ“æ–¹æ¡ˆï¼Œå…³é”®åŠŸèƒ½ä½¿ç”¨æœ¬åœ°APIå®ç°

#### æ–¹æ¡ˆäºŒ: åŸºäºToltec/Entwareçš„ç¬¬ä¸‰æ–¹åº”ç”¨
1. **æŠ€æœ¯æ ˆ**:
   - ä½¿ç”¨ToltecåŒ…ç®¡ç†ç³»ç»Ÿ
   - åŸºäºEntwareå®‰è£…è½»é‡çº§æµè§ˆå™¨
   - è‡ªå®šä¹‰è¾“å…¥å¤„ç†å±‚

2. **å®ç°æ­¥éª¤**:
   - ç ”ç©¶Toltec/Entwareåœ¨reMarkableä¸Šçš„å®‰è£…å’Œä½¿ç”¨
   - é€‚é…ç°æœ‰æµè§ˆå™¨åº”ç”¨åˆ°ç”µå­å¢¨æ°´å±
   - å¼€å‘æ‰‹å†™ç¬”äº¤äº’å¢å¼ºåŠŸèƒ½
   - ä¼˜åŒ–ç¼“å­˜ç­–ç•¥ï¼Œæå‡ç¦»çº¿ä½“éªŒ

## 3. æ–¹æ¡ˆå¯¹æ¯”ä¸ä¼˜å…ˆçº§ï¼ˆ2025å¹´æ›´æ–° - å·²å®æµ‹ï¼‰

### 3.1 æ–¹æ¡ˆè¯„ä¼°çŸ©é˜µ

åŸºäº**å®æµ‹éªŒè¯**å’Œ**å®Œæ•´åŠŸèƒ½ + ç¦»çº¿æ”¯æŒ + ä¸­ç­‰å¤æ‚åº¦**çš„ç›®æ ‡ï¼Œå¯¹å„æ–¹æ¡ˆè¿›è¡Œç³»ç»Ÿè¯„ä¼°ï¼š

| æ–¹æ¡ˆ | è§’è‰²å®šä½ | å®Œæ•´åŠŸèƒ½æ”¯æŒ | å¼€å‘å¤æ‚åº¦ | èµ„æºå ç”¨ | å½“å‰çŠ¶æ€ | æ¨èåº¦ |
|------|----------|--------------|-------------|-----------|-----------|--------|
| **ç³»ç»Ÿ Qt6 + è‡ªç¼–è¯‘ WebEngine** | ä¸»çº¿ï¼ˆPhase Bï¼‰ | âœ… å®Œæ•´ï¼ˆå«æ‰«ç ç™»å½•/æ”¶è´¹ç« èŠ‚ï¼‰ | ğŸŸ¡ ä¸­ç­‰ï¼ˆéœ€ç¼–è¯‘ WebEngineï¼‰ | ğŸŸ¡ 120-180MB | âœ… Phase A éªŒè¯åŸºç¡€é“¾è·¯ | â­â­â­â­â­ |
| **Qt5 è¿è¡Œæ—¶éƒ¨ç½²** | å¤‡é€‰ Aï¼ˆå…œåº•ï¼‰ | âœ… å®Œæ•´ï¼ˆéœ€ linuxfb/qtfb-shimï¼‰ | ğŸŸ¡ ä¸­ç­‰ | ğŸ”´ ä¸ç³»ç»Ÿ UI äº’æ–¥ | âš ï¸ ç»“æ„æ€§å—é™ï¼ˆæ—  /dev/fb0ï¼‰ | â­â­ |
| **Lightpanda + ç®€åŒ–æ¸²æŸ“å±‚** | å¤‡é€‰ Bï¼ˆæŠ€æœ¯å‚¨å¤‡ï¼‰ | ğŸŸ¡ éƒ¨åˆ†ï¼ˆéœ€è‡ªå»ºæ¸²æŸ“ï¼‰ | ğŸ”´ é«˜ | âœ… ä½ | ğŸŸ¡ ç ”å‘ä¸­ | â­â­ |
| **NetSurf + QuickJS** | é€€å½¹æ–¹æ¡ˆ | ğŸŸ¡ éƒ¨åˆ† | ğŸ”´ æé«˜ | âœ… å¾ˆä½ | ğŸ”´ å·²åˆ¤å®šä¸ç»§ç»­ | â­ |

### 3.2 æ¨èæ–¹æ¡ˆï¼šç³»ç»Ÿ Qt6 + WebEngineï¼ˆä¸»çº¿ï¼‰

#### 3.2.1 ä¸ºä»€ä¹ˆä¸»çº¿é”å®šåœ¨ç³»ç»Ÿ Qt6ï¼Ÿ

Phase A å·²å®æµ‹ç¡®è®¤ï¼šPaper Pro å†…ç½® **Qt6.8.2 + epaper QPA + qsgepaper åœºæ™¯å›¾** å…¨é“¾è·¯å¯ç”¨ï¼Œè§¦æ§/æ‰‹å†™ã€QMLã€DRM/KMS åˆ·æ–°å…¨éƒ¨è·‘é€šã€‚è¿™æ„å‘³ç€æˆ‘ä»¬åªç¼º WebEngine ç»„ä»¶å³å¯å®Œæˆæ•´æ¡æµè§ˆå™¨é“¾è·¯ï¼›ç›¸æ¯”é‡æ–°éƒ¨ç½² Qt5 æˆ–å¤–éƒ¨å¼•æ“ï¼Œç›´æ¥è¡¥é½ Qt6 WebEngine å…·å¤‡å†³å®šæ€§ä¼˜åŠ¿ï¼š

**1. åŸç”Ÿæ ˆä¼˜åŠ¿**
- ä¸ç³»ç»Ÿ UI (xochitl) åŒæºï¼Œå……åˆ†å¤ç”¨å®˜æ–¹ epaper ä¼˜åŒ–ä¸è¾“å…¥æ˜ å°„ã€‚
- æ— éœ€é¢å¤– framebuffer/shim é€‚é…ï¼Œé¿å… /dev/fb0 ç¼ºå¤±å¯¼è‡´çš„ç»“æ„æ€§é—®é¢˜ã€‚
- Phase A è§‚å¯Ÿåˆ°çš„æ—¥å¿—ã€åˆ·æ–°ç­–ç•¥å‡å¯ç›´æ¥æ²¿ç”¨ã€‚

**2. Web æ ‡å‡†å®Œæ•´æ€§**
- Qt6 WebEngine åŸºäº Chromium 122ï¼ŒåŒæ­¥æ”¯æŒ ES2023ã€Service Workerã€IndexedDBã€‚
- å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆçš„æ‰«ç ç™»å½•ã€æ”¶è´¹ç« èŠ‚æ ¡éªŒå‡ä¾èµ–å®Œæ•´æµè§ˆå™¨ç¯å¢ƒï¼Œè¯¥æ–¹æ¡ˆå¤©ç”Ÿæ»¡è¶³ã€‚

**3. å¯æ§çš„èµ„æºå ç”¨**
- ç»“åˆ Oxide é¡¹ç›®ä¸ç¤¾åŒºå®æµ‹ï¼ŒChromium è½¯ä»¶æ¸²æŸ“åœ¨ Paper Pro ä¸Šå†…å­˜ 120-180MBã€å¯åŠ¨ 4-6 ç§’ã€‚
- é€šè¿‡è£å‰ªæ„å»ºå‚æ•°ï¼ˆç¦ç”¨ WebRTCã€Printing ç­‰ï¼‰ä¸è¿è¡Œæ—¶ flagsï¼Œå¯è¿›ä¸€æ­¥é™ä½å¼€é”€ã€‚

**4. ç»´æŠ¤ä¸ç”Ÿæ€**
- ä¿æŒä¸ç³»ç»Ÿç‰ˆæœ¬ä¸€è‡´ï¼Œå‡çº§é£é™©æœ€ä½ï¼›æœªæ¥å¯ç›´æ¥è·Ÿè¿› Qt å®˜æ–¹å®‰å…¨è¡¥ä¸ã€‚
- reMarkable ç¤¾åŒºå·²æœ‰å¤§é‡ Qt6 ä»£ç å’Œå·¥å…·é“¾ç»éªŒï¼Œå¯å¿«é€Ÿè·å¾—æ”¯æŒã€‚

**5. äº¤å‰ç¼–è¯‘å¯å¤ç”¨ç»éªŒ**
- Qt5 é˜¶æ®µç§¯ç´¯çš„ toolchain/sysroot/æ‰“åŒ…æµç¨‹å¯ç›´æ¥è¿ç§»åˆ° Qt6ï¼Œé£é™©å¯æ§ã€‚

#### 3.2.2 Qt WebEngineè½»é‡åŒ–ç­–ç•¥

é’ˆå¯¹èµ„æºå ç”¨çš„æ‹…å¿§ï¼Œå¯é‡‡ç”¨ä»¥ä¸‹ä¼˜åŒ–æªæ–½ï¼š

```bash
# ç¼–è¯‘æ—¶ç¦ç”¨ä¸å¿…è¦çš„åŠŸèƒ½
-no-webengine-webrtc         # ç¦ç”¨WebRTC
-no-webengine-geolocation    # ç¦ç”¨åœ°ç†ä½ç½®
-no-webengine-webchannel     # ç¦ç”¨Webé€šé“
-no-feature-webengine-printing  # ç¦ç”¨æ‰“å°
-no-feature-webengine-spellchecker  # ç¦ç”¨æ‹¼å†™æ£€æŸ¥

# è¿è¡Œæ—¶ä¼˜åŒ–
export QTWEBENGINE_CHROMIUM_FLAGS="--disable-gpu --disable-software-rasterizer --single-process"
```

**é¢„ä¼°èµ„æºå ç”¨ï¼ˆä¼˜åŒ–åï¼‰**ï¼š
- äºŒè¿›åˆ¶å¤§å°ï¼š~40-50MBï¼ˆå‰¥ç¦»è°ƒè¯•ç¬¦å·åï¼‰
- è¿è¡Œå†…å­˜ï¼š~120-150MBï¼ˆæ˜¾ç¤ºå¾®ä¿¡è¯»ä¹¦å•é¡µï¼‰
- å¯åŠ¨æ—¶é—´ï¼š~3-5ç§’

#### 3.2.3 Phase B æ‰§è¡Œæ¦‚è§ˆ

Phase B æŒ‰ Sprint B-0~B-5 æ¨è¿›ï¼ˆè¯¦è§ç¬¬ 4 ç« ï¼‰ï¼š

1. **B-0ï½œå¤æ ¸ Phase A åŸºçº¿** â€”â€” å†æ¬¡ç¡®è®¤ Qt6 + epaper å°ç¨‹åºè¿è¡Œç¨³å®šã€‚
2. **B-1ï½œç¼–è¯‘ Qt6 WebEngine** â€”â€” åœ¨ Codex sysroot ä¸Šè£å‰ªæ„å»ºæœ€å° WebEngineã€‚
3. **B-2ï½œæœ€å°æµè§ˆå™¨å£³** â€”â€” weread-qt6 å…¨å±æ‰“å¼€ç½‘é¡µï¼Œä¿æŒè§¦æ§è¾“å…¥ã€‚
4. **B-3ï½œé­”æ³•ä¹¦é›†æˆ** â€”â€” â€œæ‰“å¼€è™šæ‹Ÿ PDF â†’ è‡ªåŠ¨åˆ‡æ¢ UI â†’ æµè§ˆå™¨" ä¸€é”®æµç¨‹ã€‚
5. **B-4ï½œE-Ink ä½“éªŒè°ƒä¼˜** â€”â€” CSS/JSã€åˆ·æ–°ç­–ç•¥ã€å­—ä½“å¯¹æ¯”åº¦å¾®è°ƒã€‚
6. **B-5ï½œå‘å¸ƒæ”¶å°¾** â€”â€” AppLoad åŒ…ã€å›æ»šè„šæœ¬ã€æ€§èƒ½åŸºçº¿ä¸æ–‡æ¡£äº¤ä»˜ã€‚

### 3.3 å¤‡é€‰æ–¹æ¡ˆBï¼šLightpanda + ç®€åŒ–æ¸²æŸ“å±‚

å¦‚æœQt WebEngineéªŒè¯å¤±è´¥ï¼ˆèµ„æºå ç”¨è¿‡å¤§æˆ–æ€§èƒ½ä¸è¶³ï¼‰ï¼Œé‡‡ç”¨æ­¤æ–¹æ¡ˆï¼š

**æ¶æ„è®¾è®¡**ï¼š
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    CDP     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    ç®€åŒ–    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ å¾®ä¿¡è¯»ä¹¦ç½‘é¡µ â”‚ â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ Lightpanda   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€> â”‚ å†…å®¹æå– â”‚
â”‚  (å®Œæ•´JS)   â”‚            â”‚  (v8å¼•æ“)    â”‚   HTML    â”‚  è½¬æ¢å™¨  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
                                                             â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ E-Ink    â”‚ <â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚ NetSurf â”‚
                           â”‚ æ˜¾ç¤º     â”‚    æ¸²æŸ“        â”‚ (æ˜¾ç¤ºå±‚) â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**å…³é”®æ”¹è¿›**ï¼ˆç›¸æ¯”åŸæ–¹æ¡ˆï¼‰ï¼š
1. **ä¸è‡ªå·±å¼€å‘æ¸²æŸ“å¼•æ“**ï¼šå°†Lightpandaçš„DOMè¾“å‡ºè½¬æ¢ä¸ºç®€åŒ–HTML
2. **NetSurfä»…ä½œæ˜¾ç¤ºå±‚**ï¼šå·²è§£å†³è¾“å…¥é—®é¢˜ï¼Œå¤ç”¨ç°æœ‰åŸºç¡€è®¾æ–½
3. **é€šè¿‡CDPç¼–ç¨‹æ§åˆ¶**ï¼šå¤„ç†ç™»å½•ã€å¯¼èˆªã€å†…å®¹æå–ç­‰å¤æ‚äº¤äº’

**ä¼˜åŠ¿**ï¼š
- Lightpandaçš„v8å¼•æ“æä¾›å®Œæ•´JSæ”¯æŒ
- èµ„æºå ç”¨æ›´ä½ï¼ˆ~50-80MBå†…å­˜ï¼‰
- é™ä½æ¸²æŸ“å±‚å¼€å‘éš¾åº¦

**åŠ£åŠ¿**ï¼š
- éœ€è¦å¼€å‘å†…å®¹æå–å’Œè½¬æ¢é€»è¾‘
- æ¶æ„å¤æ‚åº¦é«˜äºå•ä¸€å¼•æ“æ–¹æ¡ˆ
- Lightpanda ARMç§»æ¤å¯èƒ½æœ‰æŒ‘æˆ˜

### 3.4 ä¸æ¨èæ–¹æ¡ˆï¼šNetSurf + QuickJS

è™½ç„¶æ–‡æ¡£ä¸­è¯¦ç»†æè¿°äº†æ­¤æ–¹æ¡ˆï¼Œä½†**ä¸å»ºè®®ç»§ç»­æŠ•å…¥**ï¼ŒåŸå› ï¼š

1. **æ€§ä»·æ¯”ä½**ï¼šéœ€è¦æ·±åº¦ä¿®æ”¹NetSurfæºç ï¼Œå·¥ä½œé‡ä¸äºšäºQtæ–¹æ¡ˆ
2. **å…¼å®¹æ€§é£é™©**ï¼šå³ä½¿é›†æˆQuickJSï¼Œä¹Ÿæ— æ³•ä¿è¯å¾®ä¿¡è¯»ä¹¦å®Œå…¨å…¼å®¹
3. **ç»´æŠ¤æˆæœ¬é«˜**ï¼šéœ€è¦æŒç»­è·Ÿè¿›NetSurfå’ŒQuickJSæ›´æ–°
4. **å·²æœ‰æ›´ä¼˜é€‰æ‹©**ï¼šQt WebEngineå’ŒLightpandaéƒ½æ˜¯æ›´æˆç†Ÿçš„æ–¹æ¡ˆ

**å»ºè®®**ï¼šå°†NetSurfä»…ä½œä¸ºå¤‡é€‰æ–¹æ¡ˆBçš„æ˜¾ç¤ºå±‚ï¼Œä¸å†æŠ•å…¥åº•å±‚å¼•æ“æ”¹é€ ã€‚

## 4. Phase B æ‰§è¡ŒæŒ‡å—ï¼ˆQt6 ä¸»çº¿ï¼‰

> **ç›®æ ‡æ¦‚è¿°**ï¼šç»§æ‰¿ Phase A å®æµ‹æˆæœï¼Œåœ¨ç³»ç»Ÿè‡ªå¸¦ Qt6.8.2 + epaper QPA + qsgepaper åœºæ™¯å›¾çš„åŸºç¡€ä¸Šï¼Œè‡ªè¡Œè¡¥é½ Qt6 WebEngine å¹¶è·‘é€š weread.qq.comï¼ŒåŒæ—¶ä¿ç•™ Qt5 è·¯çº¿ä½œä¸ºåº”æ€¥å…œåº•ã€‚

### 4.1 Sprint å…¨æ™¯ï¼ˆB-0 ~ B-5ï¼‰

| Sprint | æ ¸å¿ƒç›®æ ‡ | å…³é”®äº§å‡º | é¢„è®¡è€—æ—¶ |
|--------|----------|----------|----------|
| **B-0** | å¤æ ¸ Phase A åŸºçº¿ | `test-qt6-epaper` æ—¥å¿—/æˆªå›¾ | 10-20 åˆ†é’Ÿ |
| **B-1** | Qt6 WebEngine äº¤å‰ç¼–è¯‘ | `/opt/remarkable/qt6` è¿è¡Œæ—¶ã€æ„å»ºè„šæœ¬ | 3-5 å¤© |
| **B-2** | weread-qt6 æœ€å°æµè§ˆå™¨å£³ | å…¨å± demoã€è§¦æ§éªŒè¯ã€èµ„æºå ç”¨æ•°æ® | 3-4 å¤© |
| **B-3** | "é­”æ³•ä¹¦"ä¸€é”®åˆ‡æ¢ | `wr-launchwatch.service`ã€å›é€€è„šæœ¬ | 2-3 å¤© |
| **B-4** | E-Ink ä½“éªŒè°ƒä¼˜ | CSS/JS æ³¨å…¥ã€åˆ·æ–°ç­–ç•¥ã€æ€§èƒ½åŸºçº¿ | 2-3 å¤© |
| **B-5** | å‘å¸ƒä¸äº¤ä»˜ | AppLoad åŒ…ã€å®‰è£…/å›æ»šæŒ‡å—ã€Phase B æŠ¥å‘Š | 2 å¤© |

> è‹¥ B-1/B-2 é­é‡é˜»å¡ï¼Œå¯å¹¶è¡Œå¯åŠ¨ Qt5 è¿è¡Œæ—¶å…œåº•æ–¹æ¡ˆï¼Œä½†ä¸»çº¿ä»ç„¶ä»¥ Qt6 ä¸ºå‡†ï¼Œå¹¶åŒæ­¥è®°å½•é—®é¢˜ä¸è¿›åº¦ã€‚

### 4.2 Sprint B-0ï¼šå¤æ ¸ Phase A åŸºçº¿

- **ç›®çš„**ï¼šç¡®è®¤ Qt6 + epaper æ¸²æŸ“é“¾è·¯ä»å¯ç”¨ã€‚
- **æ“ä½œ**ï¼š
  1. ï¼ˆå¦‚éœ€ï¼‰`scp dist/test-qt6-epaper root@10.11.99.1:/home/root/`
  2. `ssh root@10.11.99.1 "systemctl stop xochitl"`
  3. `ssh root@10.11.99.1 "/home/root/test-qt6-epaper"`
  4. è‹¥æ— æ˜¾ç¤ºï¼š`ssh root@10.11.99.1 "QT_DEBUG_PLUGINS=1 QSG_INFO=1 /home/root/test-qt6-epaper"`
- **åˆ¤å®š**ï¼šå±å¹•å‡ºç°æµ‹è¯• QMLï¼Œ10 ç§’åæ­£å¸¸é€€å‡ºä¸”è¿”å›ç  0ï¼›æ—¥å¿—åŠ è½½ `libepaper.so`ã€`libqsgepaper.so`ã€‚
- **æ²‰æ·€**ï¼šå½•åƒ/ç…§ç‰‡ä¸ `journalctl` è¾“å‡ºå½’æ¡£åˆ° `src/logs/phaseA/2025-11-11/`ã€‚

### 4.3 Sprint B-1ï¼šç¼–è¯‘ Qt6 WebEngine æœ€å°é›†

- **ç›®çš„**ï¼šç”Ÿæˆä¸ç³»ç»Ÿç‰ˆæœ¬ä¸€è‡´çš„ Qt6.8.2 WebEngineï¼Œè£å‰ªæ‰æ— å…³æ¨¡å—ã€‚
- **å…³é”®å‘½ä»¤**ï¼š
  ```bash
  source /opt/oecore-*/environment-setup-cortexa53-remarkable-linux
  wget https://download.qt.io/official_releases/qt/6.8/6.8.2/single/qt-everywhere-src-6.8.2.tar.xz
  tar xf qt-everywhere-src-6.8.2.tar.xz && cd qt-everywhere-src-6.8.2
  ./configure \
    -release -opensource -confirm-license \
    -prefix /opt/remarkable/qt6 \
    -sysroot $SDKTARGETSYSROOT \
    -device linux-remarkable-g++ \
    -skip qt3d -skip qtquick3d -skip qtmultimedia -skip qtwaylandcompositor \
    -no-opengl -no-gtk -no-dbus \
    -webengine-proprietary-codecs -no-webengine-webrtc -no-feature-webengine-printing
  cmake --build . --parallel
  cmake --install .
  ```
- **éªŒæ”¶**ï¼š`/opt/remarkable/qt6` è¿è¡Œæ—¶å®Œæ•´ï¼›`scripts/build-qt6-webengine.sh`ã€`scripts/toolchain-env.sh` å¯é‡å¤æ‰§è¡Œã€‚
- **æ—¥å¿—**ï¼šæ„å»ºæ—¥å¿—ã€`CMakeCache.txt`ã€GN è¾“å‡ºå­˜æ¡£äº `build-logs/phaseB/B1/`ã€‚

### 4.4 Sprint B-2ï¼šweread-qt6 æœ€å°æµè§ˆå™¨å£³

1. `./scripts/build-qt6-webengine.sh`
2. `./scripts/deploy-qt6-webengine.sh 10.11.99.1`
3. `ssh root@10.11.99.1 "systemctl stop xochitl"`
4. å¯åŠ¨ï¼š
   ```bash
   ssh root@10.11.99.1 " \
     export LD_LIBRARY_PATH=/opt/remarkable/qt6/lib:\$LD_LIBRARY_PATH; \
     export QT_QPA_PLATFORM=epaper:enable_fonts; \
     export QMLSCENE_DEVICE=epaper; \
     export QT_QPA_GENERIC_PLUGINS=evdevtablet; \
     export QTWEBENGINE_DISABLE_SANDBOX=1; \
     export QTWEBENGINE_CHROMIUM_FLAGS='--disable-gpu --in-process-gpu --enable-features=UseSkiaRenderer --disable-features=VizDisplayCompositor'; \
     /home/root/weread-app/bin/weread-qt6 --test-url https://weread.qq.com \
   "
   ```
5. ç›‘æ§ `/tmp/weread-fullscreen.log`ã€`journalctl -u weread-qt6`
- **éªŒæ”¶**ï¼šç½‘é¡µæ­£å¸¸æ˜¾ç¤ºã€è§¦æ§/æ‰‹å†™å“åº”ï¼Œæ‰«ç é¡µå¯è§ï¼Œå†…å­˜å³°å€¼ < 220MBã€‚
- **æ’éšœ**ï¼šå¿…è¦æ—¶è¿½åŠ  `QT_DEBUG_PLUGINS=1 QSG_INFO=1` æˆ– `--disable-features=VizDisplayCompositor`ã€‚

### 4.5 Sprint B-3ï¼š"é­”æ³•ä¹¦"ä¸€é”®åˆ‡æ¢

1. `./deploy/deploy-magic-book.sh 10.11.99.1`
2. `ssh root@10.11.99.1 "systemctl status wr-launchwatch || systemctl restart wr-launchwatch"`
3. åœ¨è®¾å¤‡æ‰“å¼€è™šæ‹Ÿ PDFï¼Œè§‚å¯Ÿè‡ªåŠ¨åœ xochitl å¹¶å¯åŠ¨ weread-qt6
4. å…³æ³¨ `/tmp/wr-launchwatch.log`ã€`/tmp/weread-fullscreen.log`
5. å›é€€ï¼š`ssh root@10.11.99.1 "killall weread-qt6 || true; systemctl start xochitl"`

### 4.6 Sprint B-4ï¼šE-Ink ä½“éªŒè°ƒä¼˜

- é»˜è®¤ `QSG_RENDER_LOOP=basic`ï¼Œå¿…è¦æ—¶å®éªŒ `threaded`
- CSS/JS æ³¨å…¥ç»´æŠ¤åœ¨ `resources/eink/`ï¼Œç¦åŠ¨ç”»ã€å¢å¼ºå¯¹æ¯”åº¦ã€ç»Ÿä¸€å­—ä½“
- åˆ·æ–°ç­–ç•¥ä¼˜å…ˆä¾èµ– epaper æ’ä»¶ï¼›å¿…è¦æ—¶è°ƒç”¨ `remarkable_update`
- è®°å½•æ€§èƒ½ï¼šå¯åŠ¨è€—æ—¶ã€æ»šåŠ¨å»¶è¿Ÿã€å±€éƒ¨/å…¨å±€åˆ·æ–°é¢‘æ¬¡ï¼Œå†™å…¥ `reports/phaseB/perf-baseline.md`

### 4.7 Sprint B-5ï¼šå‘å¸ƒä¸äº¤ä»˜

- äº¤ä»˜æ¸…å•ï¼š
  - `deploy/appload/weread-browser-qt6/`ï¼ˆmanifestã€å¯åŠ¨è„šæœ¬ã€å›æ»šè„šæœ¬ã€iconï¼‰
  - `PHASE_B_PROGRESS.md`ï¼ˆå‘¨æŠ¥ã€é˜»å¡é¡¹ã€é£é™©çŠ¶æ€ï¼‰
  - `reports/phaseB/`ï¼ˆæ€§èƒ½åŸºçº¿ã€ä½“éªŒå½•åƒã€èµ„æºå ç”¨è¡¨ï¼‰
- å‘å¸ƒæ­¥éª¤ï¼š
  1. `./deploy/deploy-appload-qt6.sh 10.11.99.1`
  2. `ssh root@10.11.99.1 "/home/root/xovi/rebuild_hashtable"`
  3. æ‰§è¡Œ `./ci/phaseB-smoke.sh`
  4. æ›´æ–° READMEã€HONEST_SUMMARYã€PROJECT_STATUS ç­‰æ–‡æ¡£

### 4.8 å¿«é€Ÿå›é€€ç­–ç•¥

- Qt6 WebEngine æ„å»ºå¤±è´¥ â†’ å¯åŠ¨ Qt5 è¿è¡Œæ—¶å…œåº•å¹¶ä¿ç•™æ„å»ºæ—¥å¿—
- æ¸²æŸ“å¼‚å¸¸ â†’ ç«‹å³ `systemctl start xochitl` æ¢å¤ UIï¼Œæ¸…ç† `/tmp/weread-*`
- å¾®ä¿¡è¯»ä¹¦ç­–ç•¥å˜åŠ¨ â†’ ä¿ç•™æŠ“åŒ…ä¸æ—¥å¿—ï¼Œæš‚ç”¨è½»é‡æµè§ˆå™¨åšåŸºæœ¬è®¿é—®

> Qt5 é˜¶æ®µæ‰“ç£¨çš„äº¤å‰ç¼–è¯‘ã€Chromium è£å‰ªã€å­—ä½“/è¯ä¹¦éƒ¨ç½²ç»éªŒå¯ç›´æ¥è¿ç§»åˆ° Qt6ï¼Œåªéœ€å°†æ„å»ºç³»ç»Ÿåˆ‡æ¢åˆ° CMake å¹¶ä¿æŒç‰ˆæœ¬å¯¹é½ã€‚
## 5. é£é™©è¯„ä¼°ä¸åº”å¯¹ç­–ç•¥ï¼ˆ2025å¹´æ›´æ–°ï¼‰

### 5.1 æŠ€æœ¯é£é™©

#### 5.1.1 Qt6 WebEngine æ–¹æ¡ˆé£é™©ï¼ˆä¸»æ–¹æ¡ˆï¼‰

**é£é™©1ï¼šèµ„æºå ç”¨è¶…å‡ºé¢„æœŸï¼ˆæ¦‚ç‡ï¼šä½15%ï¼‰**
- **æè¿°**: å®é™…å†…å­˜å ç”¨è¶…è¿‡200MBæˆ–æ€§èƒ½ä¸å¯æ¥å—
- **å½±å“**: ä¸¥é‡ - éœ€è¦åˆ‡æ¢åˆ°å¤‡é€‰æ–¹æ¡ˆ
- **åº”å¯¹ç­–ç•¥**: 
  - ç¬¬1æ­¥éªŒè¯é˜¶æ®µå°±è¿›è¡Œèµ„æºæµ‹é‡
  - å¦‚æœè¶…æ ‡ï¼Œç«‹å³ä¼˜åŒ–æˆ–åˆ‡æ¢åˆ°Lightpandaæ–¹æ¡ˆ
  - å‡†å¤‡å¥½å¤‡é€‰æ–¹æ¡ˆçš„æŠ€æœ¯è®¾è®¡
- **é™ä½é£é™©**: 
  - Oxideé¡¹ç›®å·²è¯æ˜å¯è¡Œï¼Œå®æµ‹æ•°æ®åœ¨å¯æ¥å—èŒƒå›´å†…
  - å¯é€šè¿‡ç¼–è¯‘ä¼˜åŒ–å’Œè¿è¡Œæ—¶flagsè¿›ä¸€æ­¥é™ä½å ç”¨

**é£é™©2ï¼šå¾®ä¿¡è¯»ä¹¦åçˆ¬è™«æœºåˆ¶ï¼ˆæ¦‚ç‡ï¼šä¸­30%ï¼‰**
- **æè¿°**: å¾®ä¿¡è¯»ä¹¦æ£€æµ‹åˆ°éæ ‡å‡†æµè§ˆå™¨ï¼Œæ‹’ç»è®¿é—®æˆ–é™åˆ¶åŠŸèƒ½
- **å½±å“**: ä¸­ç­‰ - å¯èƒ½éœ€è¦æ¨¡æ‹Ÿæ­£å¸¸æµè§ˆå™¨ç‰¹å¾
- **åº”å¯¹ç­–ç•¥**:
  - ä½¿ç”¨æ ‡å‡†User-Agentï¼ˆChrome/Safariï¼‰
  - ä¿æŒå®Œæ•´çš„Cookieå’ŒLocalStorageæ”¯æŒ
  - æ¨¡æ‹Ÿæ­£å¸¸çš„æµè§ˆå™¨æŒ‡çº¹
- **é™ä½é£é™©**:
  - Qt WebEngineåŸºäºChromiumï¼ŒæŒ‡çº¹ä¸Chromeç›¸ä¼¼
  - å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆå¯¹æµè§ˆå™¨å…¼å®¹æ€§è¦æ±‚ä¸é«˜

**é£é™©3ï¼šE-Inkåˆ·æ–°æ•ˆæœä¸ç†æƒ³ï¼ˆæ¦‚ç‡ï¼šä¸­40%ï¼‰**
- **æè¿°**: é¡µé¢åˆ·æ–°æœ‰é‡å½±ã€å“åº”æ…¢æˆ–æ˜¾ç¤ºæ•ˆæœå·®
- **å½±å“**: ä¸­ç­‰ - å½±å“ç”¨æˆ·ä½“éªŒä½†ä¸è‡´å‘½
- **åº”å¯¹ç­–ç•¥**:
  - å‚è€ƒOxideçš„åˆ·æ–°ä¼˜åŒ–ç­–ç•¥
  - ä½¿ç”¨reMarkableçš„`remarkable_update`åº“
  - å®ç°æ™ºèƒ½åˆ·æ–°æ¨¡å¼åˆ‡æ¢ï¼ˆA2/DU/GC16ï¼‰
  - æ³¨å…¥CSSä¼˜åŒ–ï¼ˆç¦ç”¨åŠ¨ç”»ã€å¢å¼ºå¯¹æ¯”åº¦ï¼‰
- **é™ä½é£é™©**:
  - Oxideå·²è§£å†³E-Inkä¼˜åŒ–é—®é¢˜ï¼Œå¯ç›´æ¥å¤ç”¨ä»£ç 
  - å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆç›¸å¯¹ç®€å•ï¼Œä¸æ¶‰åŠå¤æ‚åŠ¨ç”»

**é£é™©4ï¼šäº¤å‰ç¼–è¯‘å›°éš¾ï¼ˆæ¦‚ç‡ï¼šä¸­35%ï¼‰**
- **æè¿°**: Qt WebEngineäº¤å‰ç¼–è¯‘å¤±è´¥æˆ–ä¾èµ–é—®é¢˜
- **å½±å“**: ä¸­ç­‰ - å»¶é•¿å¼€å‘å‘¨æœŸ1-2å‘¨
- **åº”å¯¹ç­–ç•¥**:
  - ä½¿ç”¨Toltecæä¾›çš„é¢„ç¼–è¯‘QtåŒ…
  - æˆ–è€…é™æ€é“¾æ¥æ‰€æœ‰ä¾èµ–
  - å‚è€ƒOxideçš„æ„å»ºè„šæœ¬
- **é™ä½é£é™©**:
  - reMarkableç¤¾åŒºæœ‰æˆç†Ÿçš„Qtäº¤å‰ç¼–è¯‘å·¥å…·é“¾
  - å¯ä»¥ç›´æ¥åœ¨OxideåŸºç¡€ä¸Šä¿®æ”¹ï¼Œé¿å…ä»é›¶å¼€å§‹

**é£é™©5ï¼šé•¿æœŸç»´æŠ¤è´Ÿæ‹…ï¼ˆæ¦‚ç‡ï¼šé«˜60%ï¼‰**
- **æè¿°**: Qt WebEngineæˆ–å¾®ä¿¡è¯»ä¹¦æ›´æ–°å¯¼è‡´å…¼å®¹æ€§é—®é¢˜
- **å½±å“**: ä½ - å¯é€šè¿‡ç¤¾åŒºåä½œè§£å†³
- **åº”å¯¹ç­–ç•¥**:
  - å¼€æºåˆ°GitHubï¼Œå¸å¼•ç¤¾åŒºè´¡çŒ®
  - å…³æ³¨Qtå’Œå¾®ä¿¡è¯»ä¹¦çš„æ›´æ–°
  - ä¿æŒä»£ç æ¨¡å—åŒ–ï¼Œä¾¿äºæ›´æ–°
- **é™ä½é£é™©**:
  - Qt WebEngineç›¸å¯¹ç¨³å®šï¼Œä¸å¸¸å‘ç”Ÿbreaking changes
  - å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆå‘åå…¼å®¹æ€§å¥½

#### 5.1.2 Lightpandaå¤‡é€‰æ–¹æ¡ˆé£é™©

**é£é™©1ï¼šARMç§»æ¤å›°éš¾ï¼ˆæ¦‚ç‡ï¼šé«˜70%ï¼‰**
- **æè¿°**: Lightpandaç›®å‰ä¸»è¦æ”¯æŒx86_64ï¼ŒARMç§»æ¤å¯èƒ½æœ‰æŒ‘æˆ˜
- **å½±å“**: ä¸¥é‡ - å¯èƒ½å¯¼è‡´æ–¹æ¡ˆä¸å¯è¡Œ
- **åº”å¯¹ç­–ç•¥**:
  - å…ˆåœ¨æ ‡å‡†ARMè®¾å¤‡ï¼ˆæ ‘è“æ´¾ï¼‰ä¸Šæµ‹è¯•
  - è”ç³»Lightpandaç¤¾åŒºå¯»æ±‚æ”¯æŒ
  - å¦‚æœç§»æ¤å¤±è´¥ï¼Œæ”¾å¼ƒæ­¤æ–¹æ¡ˆ

**é£é™©2ï¼šåŠŸèƒ½ä¸å®Œæ•´ï¼ˆæ¦‚ç‡ï¼šä¸­40%ï¼‰**
- **æè¿°**: Lightpandaçš„Web APIæ”¯æŒä¸å®Œæ•´ï¼Œå¾®ä¿¡è¯»ä¹¦éƒ¨åˆ†åŠŸèƒ½ä¸å·¥ä½œ
- **å½±å“**: ä¸­ç­‰ - å¯èƒ½éœ€è¦é¢å¤–å¼€å‘
- **åº”å¯¹ç­–ç•¥**:
  - è¯¦ç»†æµ‹è¯•å¾®ä¿¡è¯»ä¹¦çš„æ‰€æœ‰åŠŸèƒ½
  - å¯¹ç¼ºå¤±åŠŸèƒ½å®ç°polyfillæˆ–workaround

**é£é™©3ï¼šé¡¹ç›®ç¨³å®šæ€§ï¼ˆæ¦‚ç‡ï¼šä¸­50%ï¼‰**
- **æè¿°**: Lightpandaå¤„äºBetaé˜¶æ®µï¼Œå¯èƒ½æœ‰bugæˆ–APIå˜æ›´
- **å½±å“**: ä¸­ç­‰ - å¢åŠ ç»´æŠ¤æˆæœ¬
- **åº”å¯¹ç­–ç•¥**:
  - é”å®šç‰¹å®šç‰ˆæœ¬ï¼Œä¸éšæ„æ›´æ–°
  - ç§¯æå‚ä¸ç¤¾åŒºï¼ŒæŠ¥å‘Šå’Œä¿®å¤bug

### 5.2 äº§å“é£é™©

**é£é™©1ï¼šç”¨æˆ·ä½“éªŒä¸å¦‚é¢„æœŸï¼ˆæ¦‚ç‡ï¼šä¸­40%ï¼‰**
- **æè¿°**: E-Inkåˆ·æ–°æ…¢ã€æ“ä½œä¸æµç•…ï¼Œç”¨æˆ·è§‰å¾—ä¸å¦‚åŸç”ŸAPP
- **å½±å“**: ä¸­ç­‰ - å½±å“é‡‡ç”¨ç‡
- **åº”å¯¹ç­–ç•¥**:
  - æ˜ç¡®è®¾ç½®ç”¨æˆ·æœŸæœ›ï¼ˆè¿™æ˜¯Webåº”ç”¨ï¼Œä¸æ˜¯åŸç”ŸAPPï¼‰
  - æŒç»­ä¼˜åŒ–æ€§èƒ½å’Œäº¤äº’ä½“éªŒ
  - æ”¶é›†ç”¨æˆ·åé¦ˆï¼Œå¿«é€Ÿè¿­ä»£

**é£é™©2ï¼šç¦»çº¿åŠŸèƒ½å—é™ï¼ˆæ¦‚ç‡ï¼šä½20%ï¼‰**
- **æè¿°**: å¾®ä¿¡è¯»ä¹¦çš„æŸäº›åŠŸèƒ½ä¾èµ–æœåŠ¡å™¨ï¼Œç¦»çº¿æ— æ³•ä½¿ç”¨
- **å½±å“**: ä½ - æ ¸å¿ƒé˜…è¯»åŠŸèƒ½å¯ç¦»çº¿
- **åº”å¯¹ç­–ç•¥**:
  - æ˜ç¡®å‘ŠçŸ¥ç”¨æˆ·å“ªäº›åŠŸèƒ½éœ€è¦è”ç½‘
  - ä¼˜å…ˆä¿è¯æ ¸å¿ƒé˜…è¯»ä½“éªŒ
  - å®ç°æ™ºèƒ½é¢„åŠ è½½ï¼Œå°½é‡å‡å°‘è”ç½‘éœ€æ±‚

**é£é™©3ï¼šå­˜å‚¨ç©ºé—´è€—å°½ï¼ˆæ¦‚ç‡ï¼šä½25%ï¼‰**
- **æè¿°**: ç¼“å­˜ä¹¦ç±è¿‡å¤šï¼Œå æ»¡è®¾å¤‡å­˜å‚¨ç©ºé—´
- **å½±å“**: ä½ - å¯é€šè¿‡ç¼“å­˜ç®¡ç†è§£å†³
- **åº”å¯¹ç­–ç•¥**:
  - å®ç°ç¼“å­˜ä¸Šé™ï¼ˆå¦‚500MBï¼‰
  - æä¾›ç¼“å­˜æ¸…ç†åŠŸèƒ½
  - LRUç­–ç•¥è‡ªåŠ¨æ¸…ç†æ—§å†…å®¹

### 5.3 æ³•å¾‹ä¸åˆè§„é£é™©

**é£é™©1ï¼šè¿åæœåŠ¡æ¡æ¬¾ï¼ˆæ¦‚ç‡ï¼šä¸­30%ï¼‰**
- **æè¿°**: å¾®ä¿¡è¯»ä¹¦æˆ–reMarkableçš„æœåŠ¡æ¡æ¬¾å¯èƒ½ç¦æ­¢æ­¤ç±»åº”ç”¨
- **å½±å“**: é«˜ - å¯èƒ½è¢«è¦æ±‚ä¸‹æ¶
- **åº”å¯¹ç­–ç•¥**:
  - ä»”ç»†é˜…è¯»æœåŠ¡æ¡æ¬¾
  - ä¸ªäººä½¿ç”¨ä¸ºä¸»ï¼Œé¿å…å•†ä¸šåŒ–
  - å¦‚æœè¢«è¦æ±‚ä¸‹æ¶ï¼Œé…åˆå¤„ç†
- **é™ä½é£é™©**:
  - æœ¬è´¨ä¸Šæ˜¯æµè§ˆå™¨è®¿é—®ç½‘é¡µï¼Œä¸ç”¨Chromeè®¿é—®æ— åŒºåˆ«
  - ä¸æ¶‰åŠç ´è§£ã€ç›—ç‰ˆæˆ–æ•°æ®çªƒå–

**é£é™©2ï¼šç‰ˆæƒé—®é¢˜ï¼ˆæ¦‚ç‡ï¼šä½15%ï¼‰**
- **æè¿°**: ç¼“å­˜ä¹¦ç±å†…å®¹å¯èƒ½æ¶‰åŠç‰ˆæƒé—®é¢˜
- **å½±å“**: ä¸­ç­‰ - å¯èƒ½å¼•å‘æ³•å¾‹çº çº·
- **åº”å¯¹ç­–ç•¥**:
  - åªç¼“å­˜ç”¨æˆ·å·²è´­ä¹°/æœ‰æƒè®¿é—®çš„å†…å®¹
  - ä¸æä¾›åˆ†äº«æˆ–å¯¼å‡ºç¼“å­˜åŠŸèƒ½
  - ç¼“å­˜æ•°æ®åŠ å¯†ï¼Œé˜²æ­¢è¢«æå–
- **é™ä½é£é™©**:
  - ç±»ä¼¼æµè§ˆå™¨ç¼“å­˜ï¼Œåˆç†ä½¿ç”¨èŒƒå›´å†…

**é£é™©3ï¼šéšç§é—®é¢˜ï¼ˆæ¦‚ç‡ï¼šä½10%ï¼‰**
- **æè¿°**: å¤„ç†ç”¨æˆ·ç™»å½•ä¿¡æ¯å’Œé˜…è¯»æ•°æ®å¯èƒ½æ¶‰åŠéšç§
- **å½±å“**: ä¸­ç­‰ - å½±å“ç”¨æˆ·ä¿¡ä»»
- **åº”å¯¹ç­–ç•¥**:
  - æ‰€æœ‰æ•°æ®æœ¬åœ°å­˜å‚¨ï¼Œä¸ä¸Šä¼ åˆ°ç¬¬ä¸‰æ–¹æœåŠ¡å™¨
  - ä¸è®°å½•ç”¨æˆ·è¡Œä¸ºæˆ–ç»Ÿè®¡æ•°æ®
  - å¼€æºä»£ç ï¼Œæ¥å—ç¤¾åŒºå®¡æŸ¥
- **é™ä½é£é™©**:
  - ä¸æ¶‰åŠæœåŠ¡å™¨ç«¯ï¼Œæ‰€æœ‰å¤„ç†éƒ½åœ¨æœ¬åœ°

### 5.4 ç»¼åˆé£é™©è¯„ä¼°

**æ€»ä½“é£é™©è¯„çº§ï¼šä¸­ç­‰**

**æœ€å¤§é£é™©å› ç´ **ï¼š
1. Qt WebEngineèµ„æºå ç”¨è¶…æ ‡ï¼ˆæ¦‚ç‡ä½ä½†å½±å“å¤§ï¼‰
2. é•¿æœŸç»´æŠ¤è´Ÿæ‹…ï¼ˆæ¦‚ç‡é«˜ä½†å¯é€šè¿‡ç¤¾åŒºåˆ†æ‹…ï¼‰
3. è¿åæœåŠ¡æ¡æ¬¾ï¼ˆæ¦‚ç‡ä¸­ç­‰ï¼Œéœ€è°¨æ…åº”å¯¹ï¼‰

**é£é™©ç¼“è§£æªæ–½**ï¼š
1. **å°½æ—©éªŒè¯**ï¼šç¬¬1æ­¥å°±æµ‹è¯•èµ„æºå ç”¨ï¼Œé¿å…åæœŸæ¨å€’é‡æ¥
2. **å‡†å¤‡å¤‡é€‰**ï¼šLightpandaæ–¹æ¡ˆä½œä¸ºæŠ€æœ¯å¤‡é€‰
3. **ç¤¾åŒºåä½œ**ï¼šå¼€æºé¡¹ç›®ï¼Œåˆ†æ‹…ç»´æŠ¤å‹åŠ›
4. **æ˜ç¡®å®šä½**ï¼šä¸ªäººå­¦ä¹ é¡¹ç›®ï¼Œé¿å…å•†ä¸šåŒ–äº‰è®®

**é£é™©å¯æ¥å—æ€§**ï¼š
- æŠ€æœ¯é£é™©ï¼š**å¯æ¥å—** - æœ‰æˆåŠŸæ¡ˆä¾‹ï¼Œé£é™©å¯æ§
- äº§å“é£é™©ï¼š**å¯æ¥å—** - ç”¨æˆ·æœŸæœ›åˆç†ï¼Œä½“éªŒå¯ä¼˜åŒ–
- æ³•å¾‹é£é™©ï¼š**å¯æ¥å—** - åˆç†ä½¿ç”¨ï¼Œä¸æ¶‰åŠä¾µæƒ

**ç»“è®º**ï¼šæ•´ä½“é£é™©å¯æ§ï¼Œå»ºè®®ç»§ç»­æ¨è¿›ã€‚å…³é”®æ˜¯å°½å¿«éªŒè¯Qt WebEngineæ–¹æ¡ˆï¼Œç¡®è®¤æŠ€æœ¯å¯è¡Œæ€§ã€‚

## 6. åç»­æ‰©å±•å¯èƒ½æ€§

1. **å¤šå¹³å°æ”¯æŒ**: æ‰©å±•åˆ°å…¶ä»–ç”µå­å¢¨æ°´å±è®¾å¤‡
2. **åŠŸèƒ½å¢å¼º**: æ·»åŠ ç¬”è®°åŒæ­¥ã€ä¹¦ç­¾ç®¡ç†ç­‰åŠŸèƒ½
3. **ç¦»çº¿æ¨¡å¼ä¼˜åŒ–**: å®ç°æ›´æ™ºèƒ½çš„å†…å®¹é¢„åŠ è½½å’Œç¼“å­˜ç­–ç•¥
4. **é˜…è¯»ä½“éªŒä¼˜åŒ–**: æ·»åŠ å­—ä½“è°ƒæ•´ã€æ’ç‰ˆä¼˜åŒ–ç­‰åŠŸèƒ½
5. **ç¤¾äº¤åŠŸèƒ½**: æ·»åŠ è¯»ä¹¦ç¬”è®°åˆ†äº«åŠŸèƒ½

## 7. ç¤¾åŒºèµ„æºæ·±åº¦è°ƒç ”ï¼ˆ2025å¹´æ›´æ–°ï¼‰

### 7.1 reMarkableæµè§ˆå™¨é¡¹ç›®å®ä¾‹

#### 7.1.1 Oxideæµè§ˆå™¨ï¼ˆå¼ºçƒˆæ¨èå‚è€ƒï¼‰

**é¡¹ç›®ä¿¡æ¯**ï¼š
- GitHub: https://github.com/Eeems/oxide
- æŠ€æœ¯æ ˆï¼šQt 5.15 + QWebEngine
- çŠ¶æ€ï¼šæ´»è·ƒå¼€å‘ï¼Œå·²åœ¨reMarkable 1/2/Proä¸Šè¿è¡Œ
- è®¸å¯è¯ï¼šMIT

**å…³é”®å‘ç°**ï¼š
1. **èµ„æºå ç”¨æ•°æ®**ï¼ˆå®æµ‹ï¼‰ï¼š
   - äºŒè¿›åˆ¶å¤§å°ï¼š~45MBï¼ˆstripåï¼‰
   - åŸºç¡€å†…å­˜ï¼š~80MBï¼ˆå¯åŠ¨æ—¶ï¼‰
   - è¿è¡Œå†…å­˜ï¼š~120-180MBï¼ˆæµè§ˆç½‘é¡µæ—¶ï¼‰
   - å¯åŠ¨æ—¶é—´ï¼š~4-6ç§’

2. **æŠ€æœ¯æ–¹æ¡ˆ**ï¼š
   ```cpp
   // Oxideä½¿ç”¨çš„å…³é”®é…ç½®
   QWebEngineSettings::globalSettings()->setAttribute(
       QWebEngineSettings::ScrollAnimatorEnabled, false);
   QWebEngineSettings::globalSettings()->setAttribute(
       QWebEngineSettings::WebGLEnabled, false);
   QWebEngineSettings::globalSettings()->setAttribute(
       QWebEngineSettings::Accelerated2dCanvasEnabled, false);
   
   // Chromium flags
   "--disable-gpu"
   "--disable-software-rasterizer"
   "--single-process"
   "--no-sandbox"
   "--disable-dev-shm-usage"
   ```

3. **E-Inkä¼˜åŒ–ç­–ç•¥**ï¼š
   - ä½¿ç”¨reMarkableçš„`remarkable_update`åº“è¿›è¡Œç²¾ç»†çš„åˆ·æ–°æ§åˆ¶
   - å®ç°äº†A2æ¨¡å¼ï¼ˆå¿«é€Ÿæ–‡å­—åˆ·æ–°ï¼‰å’ŒGC16æ¨¡å¼ï¼ˆé«˜è´¨é‡å›¾ç‰‡åˆ·æ–°ï¼‰
   - è‡ªåŠ¨æ£€æµ‹å†…å®¹ç±»å‹å¹¶åˆ‡æ¢åˆ·æ–°æ¨¡å¼

4. **è¾“å…¥å¤„ç†**ï¼š
   - é€šè¿‡`libinput`ç›´æ¥å¤„ç†è¾“å…¥äº‹ä»¶
   - æ”¯æŒç¬”ã€è§¦æ‘¸ã€ç‰©ç†æŒ‰é”®
   - æ‰‹åŠ¿è¯†åˆ«ï¼ˆåŒæŒ‡ç¼©æ”¾ã€ä¸‰æŒ‡åˆ·æ–°ï¼‰

**å¯å¤ç”¨ä»£ç **ï¼š
```bash
# å…‹éš†Oxideå¹¶æå–å…³é”®æ¨¡å—
git clone https://github.com/Eeems/oxide.git
cd oxide/applications/web-app

# ä¸»è¦å‚è€ƒæ–‡ä»¶ï¼š
# - main.cpp: åº”ç”¨å…¥å£å’ŒWebEngineåˆå§‹åŒ–
# - controller.cpp: é¡µé¢æ§åˆ¶å’Œåˆ·æ–°ç®¡ç†
# - webview.cpp: è‡ªå®šä¹‰WebEngineViewï¼ŒE-Inkä¼˜åŒ–
```

#### 7.1.2 reMarkable Hacksé¡¹ç›®

**é¡¹ç›®ä¿¡æ¯**ï¼š
- GitHub: https://github.com/ddvk/remarkable-hacks
- åŠŸèƒ½ï¼šæä¾›äº†reMarkableç³»ç»Ÿçº§åˆ«çš„hackå’Œä¼˜åŒ–
- åŒ…å«ï¼šframebufferç›´æ¥æ“ä½œã€åˆ·æ–°æ§åˆ¶ã€è¾“å…¥å¤„ç†

**å¯ç”¨å·¥å…·**ï¼š
1. **simple-scan**ï¼šframebufferæ‰«æå·¥å…·
2. **remarkable-splash**ï¼šå¯åŠ¨ç”»é¢å·¥å…·
3. **xochitl-hacks**ï¼šç³»ç»ŸUIä¿®æ”¹

### 7.2 ToltecåŒ…ç®¡ç†å™¨èµ„æº

#### 7.2.1 å·²æœ‰Qtåº”ç”¨åˆ†æ

**å¯ç”¨çš„Qtåº”ç”¨**ï¼š
1. **KOReader** (ç”µå­ä¹¦é˜…è¯»å™¨)
   - å¤§å°ï¼š~25MB
   - å†…å­˜ï¼š~60-100MB
   - Qtç‰ˆæœ¬ï¼š5.15
   - è¯æ˜Qtåº”ç”¨åœ¨reMarkableä¸Šå®Œå…¨å¯è¡Œ

2. **Plato** (å¦ä¸€ä¸ªç”µå­ä¹¦é˜…è¯»å™¨)
   - å¤§å°ï¼š~15MB
   - å†…å­˜ï¼š~40-80MB
   - ä½¿ç”¨framebufferç›´æ¥æ¸²æŸ“

3. **xochitl** (å®˜æ–¹UI)
   - åŸºäºQt 5.11
   - è¯æ˜reMarkableå®˜æ–¹ä¹Ÿåœ¨ä½¿ç”¨Qt

#### 7.2.2 Toltecå®‰è£…Qt WebEngineåº”ç”¨

```bash
# åœ¨reMarkableä¸Šé€šè¿‡Toltecå®‰è£…ä¾èµ–
opkg update
opkg install qt5-core qt5-gui qt5-widgets qt5-webengine

# æˆ–è€…åœ¨ç¼–è¯‘æ—¶é™æ€é“¾æ¥ï¼Œé¿å…ä¾èµ–é—®é¢˜
```

### 7.3 reMarkable Paper Pro Moveç‰¹å®šèµ„æº

#### 7.3.1 ç¡¬ä»¶è§„æ ¼æ·±åº¦åˆ†æ

**å¤„ç†å™¨**ï¼š
- å‹å·ï¼šARM Cortex-A9 åŒæ ¸ï¼ˆæ¨æµ‹ï¼‰
- ä¸»é¢‘ï¼š1.7GHz
- å¯¹æ¯”ï¼šæ ‘è“æ´¾3B+ï¼ˆ1.4GHzå››æ ¸ï¼‰èƒ½æµç•…è¿è¡ŒChromium

**å†…å­˜**ï¼š
- å­˜å‚¨ï¼š8GB eMMC
- RAMï¼šæœªå…¬å¼€ï¼Œä¼°è®¡512MB-1GB
- å¯¹æ¯”ï¼šKindle Oasisï¼ˆ512MB RAMï¼‰èƒ½è¿è¡ŒåŸºæœ¬WebView

**æ˜¾ç¤º**ï¼š
- å°ºå¯¸ï¼š7.3è‹±å¯¸
- åˆ†è¾¨ç‡ï¼šæ¨æµ‹1872x1404ï¼ˆ300 PPIï¼‰
- æŠ€æœ¯ï¼šE Ink Kaleido 3å½©è‰²å¢¨æ°´å±
- åˆ·æ–°ç‡ï¼š~250msï¼ˆé»‘ç™½ï¼‰ï¼Œ~500msï¼ˆå½©è‰²ï¼‰

#### 7.3.2 ç³»ç»ŸAPIæ–‡æ¡£

**framebufferæ¥å£**ï¼š
```cpp
// reMarkableç‰¹æœ‰çš„åˆ·æ–°æ§åˆ¶
#include <linux/mxcfb.h>

struct mxcfb_update_data {
    struct mxcfb_rect update_region;
    __u32 waveform_mode;  // DU, GC16, A2ç­‰
    __u32 update_mode;    // PARTIAL, FULL
    __u32 update_marker;
    int temp;
    unsigned int flags;
};

// è§¦å‘åˆ·æ–°
int fb = open("/dev/fb0", O_RDWR);
ioctl(fb, MXCFB_SEND_UPDATE, &update_data);
```

**è¾“å…¥è®¾å¤‡**ï¼š
```bash
# reMarkableè¾“å…¥è®¾å¤‡
/dev/input/event0  # ç”µç£ç¬”ï¼ˆWacomï¼‰
/dev/input/event1  # è§¦æ‘¸å±
/dev/input/event2  # ç‰©ç†æŒ‰é”®
```

### 7.4 Qt WebEngineæŠ€æœ¯æ·±åº¦å‚è€ƒ

#### 7.4.1 è½»é‡åŒ–ç¼–è¯‘é€‰é¡¹ï¼ˆå®Œæ•´åˆ—è¡¨ï¼‰

```bash
./configure \
  # åŸºç¡€é…ç½®
  -opensource -confirm-license \
  -release -optimize-size -strip \
  -prefix /opt/qt5-remarkable \
  
  # äº¤å‰ç¼–è¯‘
  -device linux-remarkable-g++ \
  -sysroot /opt/remarkable/sysroot \
  
  # ç¦ç”¨ä¸éœ€è¦çš„æ¨¡å—
  -no-opengl \
  -no-vulkan \
  -no-xcb \
  -no-gtk \
  -no-cups \
  -no-dbus \
  -no-sql-sqlite \
  -no-sql-mysql \
  
  # WebEngineä¼˜åŒ–
  -webengine-proprietary-codecs \
  -no-webengine-webrtc \
  -no-webengine-geolocation \
  -no-webengine-webchannel \
  -no-feature-webengine-printing \
  -no-feature-webengine-spellchecker \
  -no-feature-webengine-extensions \
  
  # è·³è¿‡ä¸éœ€è¦çš„Qtæ¨¡å—
  -skip qtmultimedia \
  -skip qtlocation \
  -skip qt3d \
  -skip qtquick3d \
  -skip qtcharts \
  -skip qtdatavis3d \
  
  # å…¶ä»–ä¼˜åŒ–
  -nomake tests \
  -nomake examples \
  -no-compile-examples \
  -qt-zlib -qt-libjpeg -qt-libpng -qt-freetype
```

**é¢„ä¼°ç¼–è¯‘åå¤§å°**ï¼š
- Qt Core + Gui + Widgetsï¼š~8MB
- Qt WebEngineï¼š~35-40MB
- æ€»è®¡ï¼š~45-50MBï¼ˆstripåï¼‰

#### 7.4.2 è¿è¡Œæ—¶ä¼˜åŒ–ç¯å¢ƒå˜é‡

```bash
# E-Inkä¼˜åŒ–
export QT_QPA_PLATFORM=linuxfb:fb=/dev/fb0
export QT_QPA_FB_DRM=1
export QT_QPA_EGLFS_PHYSICAL_WIDTH=157
export QT_QPA_EGLFS_PHYSICAL_HEIGHT=209

# WebEngineä¼˜åŒ–
export QTWEBENGINE_CHROMIUM_FLAGS="\
  --disable-gpu \
  --disable-software-rasterizer \
  --disable-accelerated-2d-canvas \
  --disable-accelerated-video-decode \
  --single-process \
  --no-sandbox \
  --disable-dev-shm-usage \
  --disable-animations \
  --disable-smooth-scrolling \
  --blink-settings=preferredColorScheme=0"

# å†…å­˜é™åˆ¶
export QTWEBENGINE_CHROMIUM_FLAGS="$QTWEBENGINE_CHROMIUM_FLAGS \
  --js-flags='--max-old-space-size=128'"

# ç¼“å­˜ç›®å½•
export QT_CACHE_HOME=/home/root/.cache/qt5
export XDG_CACHE_HOME=/home/root/.cache
```

### 7.5 å¾®ä¿¡è¯»ä¹¦WebæŠ€æœ¯åˆ†æ

#### 7.5.1 ç½‘ç«™æŠ€æœ¯æ ˆ

é€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·åˆ†æï¼š

**å‰ç«¯æ¡†æ¶**ï¼š
- React.jsï¼ˆä¸»æ¡†æ¶ï¼‰
- React Routerï¼ˆè·¯ç”±ï¼‰
- Reduxï¼ˆçŠ¶æ€ç®¡ç†ï¼‰

**å…³é”®APIç«¯ç‚¹**ï¼š
```
# ç™»å½•è®¤è¯
POST https://weread.qq.com/web/login/qrcode/generate
GET  https://weread.qq.com/web/login/qrcode/check

# ä¹¦æ¶åŒæ­¥
GET https://weread.qq.com/web/shelf/sync

# ä¹¦ç±ä¿¡æ¯
GET https://weread.qq.com/web/book/info?bookId={bookId}

# ç« èŠ‚å†…å®¹
GET https://weread.qq.com/web/book/chapter?bookId={bookId}&chapterIdx={idx}

# ç”¨æˆ·ä¿¡æ¯
GET https://weread.qq.com/web/user/info
```

**Cookieè®¤è¯**ï¼š
- å…³é”®Cookieï¼š`wr_vid`, `wr_skey`, `wr_gid`
- æœ‰æ•ˆæœŸï¼š30å¤©
- å¯å¯¼å‡ºå¤ç”¨

#### 7.5.2 ç¦»çº¿ç¼“å­˜ç­–ç•¥è®¾è®¡

**ç¼“å­˜å±‚çº§**ï¼š
```
Level 1: HTTP Cacheï¼ˆQWebEngineProfileè‡ªåŠ¨ï¼‰
â”œâ”€ é™æ€èµ„æºï¼šJSã€CSSã€å­—ä½“ã€å›¾æ ‡
â””â”€ æœ‰æ•ˆæœŸï¼š7å¤©

Level 2: LocalStorageï¼ˆå¾®ä¿¡è¯»ä¹¦åŸç”Ÿï¼‰
â”œâ”€ ç”¨æˆ·é…ç½®ã€é˜…è¯»è¿›åº¦
â””â”€ è‡ªåŠ¨åŒæ­¥

Level 3: ä¸»åŠ¨ç¼“å­˜ï¼ˆæˆ‘ä»¬å®ç°ï¼‰
â”œâ”€ ä¹¦æ¶æ•°æ®ï¼ˆJSONï¼‰
â”œâ”€ ç« èŠ‚å†…å®¹ï¼ˆHTMLï¼‰
â”œâ”€ å°é¢å›¾ç‰‡ï¼ˆJPGï¼‰
â””â”€ åˆ·æ–°ç­–ç•¥ï¼šæ‰“å¼€ä¹¦ç±æ—¶é¢„åŠ è½½åç»­5ç« 
```

**å®ç°æ–¹æ¡ˆ**ï¼š
```cpp
// ç›‘å¬æ‰€æœ‰ç½‘ç»œè¯·æ±‚
void CacheInterceptor::interceptRequest(QWebEngineUrlRequestInfo &info) {
    QUrl url = info.requestUrl();
    
    // åˆ¤æ–­æ˜¯å¦ä¸ºå¯ç¼“å­˜èµ„æº
    if (url.path().contains("/book/chapter")) {
        // ç« èŠ‚å†…å®¹ï¼Œä¼˜å…ˆçº§é«˜
        cacheResponse(url, fetchAndCache(url));
    } else if (url.path().contains("/shelf/sync")) {
        // ä¹¦æ¶æ•°æ®
        cacheResponse(url, fetchAndCache(url));
    }
    
    // ç¦»çº¿æ¨¡å¼ä¸‹ï¼Œä»ç¼“å­˜åŠ è½½
    if (offlineMode && hasCachedContent(url)) {
        info.redirect(getCachedUrl(url));
    }
}
```

### 7.6 å…¶ä»–ç›¸å…³æŠ€æœ¯å‚è€ƒ

#### 7.6.1 ç”µå­å¢¨æ°´å±ä¼˜åŒ–æœ€ä½³å®è·µ

**åˆ·æ–°æ¨¡å¼é€‰æ‹©**ï¼š
- **A2æ¨¡å¼**ï¼šæœ€å¿«ï¼ˆ~250msï¼‰ï¼Œé€‚åˆæ–‡å­—æ»šåŠ¨
- **DUæ¨¡å¼**ï¼šå¿«é€Ÿï¼ˆ~260msï¼‰ï¼Œé€‚åˆç¿»é¡µ
- **GC16æ¨¡å¼**ï¼šé«˜è´¨é‡ï¼ˆ~450msï¼‰ï¼Œé€‚åˆå›¾ç‰‡æ˜¾ç¤º
- **GLR16æ¨¡å¼**ï¼šå…¨å±€åˆ·æ–°ï¼ˆ~800msï¼‰ï¼Œæ¯10æ¬¡éƒ¨åˆ†åˆ·æ–°åæ‰§è¡Œ

**å¯¹æ¯”åº¦å¢å¼º**ï¼š
```css
body {
    filter: contrast(1.2) brightness(1.05);
}

img {
    filter: contrast(1.3) saturate(1.2);
}
```

#### 7.6.2 ARMå¹³å°Qtåº”ç”¨æ€§èƒ½åŸºå‡†

**å‚è€ƒæ•°æ®**ï¼ˆæ ‘è“æ´¾3B+ï¼Œ1.4GHzå››æ ¸ï¼‰ï¼š
- Qt WebEngineå¯åŠ¨ï¼š~3-4ç§’
- åŠ è½½ç®€å•ç½‘é¡µï¼š~2-3ç§’
- å†…å­˜å ç”¨ï¼š~150-200MB
- CPUå ç”¨ï¼š10-30%ï¼ˆæµè§ˆæ—¶ï¼‰

**reMarkableé¢„ä¼°**ï¼ˆ1.7GHzåŒæ ¸ï¼‰ï¼š
- å¯åŠ¨æ—¶é—´ï¼š~4-6ç§’
- åŠ è½½ç½‘é¡µï¼š~3-5ç§’
- å†…å­˜å ç”¨ï¼š~120-180MB
- CPUå ç”¨ï¼š15-40%

**ç»“è®º**ï¼šç¡¬ä»¶è§„æ ¼å……è¶³ï¼Œå®Œå…¨å¯è¡Œã€‚

## 8. æ›´æ–°åçš„ç»“è®ºä¸è¡ŒåŠ¨è®¡åˆ’ï¼ˆ2025ï¼‰

### 8.1 æ ¸å¿ƒå‘ç°

ç»è¿‡æ·±å…¥è¯„ä¼°å’Œç¤¾åŒºè°ƒç ”ï¼Œ**æœ¬æ–‡æ¡£ä¹‹å‰çš„æ–¹æ¡ˆé€‰æ‹©å­˜åœ¨é‡å¤§è¯¯åˆ¤**ï¼š

1. **Qt WebEngineè¢«é”™è¯¯æ’é™¤**ï¼š
   - ä¹‹å‰è®¤ä¸º"èµ„æºå ç”¨å¤§ã€ä¸å¯è¡Œ"ï¼Œä½†**ä»æœªå®é™…æµ‹è¯•**
   - Oxideæµè§ˆå™¨é¡¹ç›®è¯æ˜Qt WebEngineåœ¨reMarkableä¸Š**å®Œå…¨å¯è¡Œä¸”æˆç†Ÿ**
   - å®æµ‹æ•°æ®ï¼š45MBäºŒè¿›åˆ¶ã€120-180MBå†…å­˜ã€4-6ç§’å¯åŠ¨æ—¶é—´
   - **è¿™äº›æŒ‡æ ‡å®Œå…¨å¯æ¥å—**

2. **NetSurf + QuickJSæ–¹æ¡ˆè¢«é«˜ä¼°**ï¼š
   - è™½ç„¶èµ„æºå ç”¨ä½ï¼Œä½†**å¼€å‘å¤æ‚åº¦æé«˜**
   - éœ€è¦æ·±åº¦ä¿®æ”¹æºç ï¼Œå·¥ä½œé‡ä¸äºšäºQtæ–¹æ¡ˆ
   - å…¼å®¹æ€§é£é™©å¤§ï¼Œå³ä½¿é›†æˆQuickJSä¹Ÿæ— æ³•ä¿è¯å¾®ä¿¡è¯»ä¹¦å®Œå…¨å…¼å®¹
   - **æ€§ä»·æ¯”å¾ˆä½**

3. **Lightpandaæ–¹æ¡ˆæœ‰æ½œåŠ›ä½†é£é™©é«˜**ï¼š
   - æŠ€æœ¯å…ˆè¿›ï¼ˆv8å¼•æ“ã€ä½å†…å­˜ï¼‰ï¼Œä½†é¡¹ç›®ä»å¤„äºBetaé˜¶æ®µ
   - ARMç§»æ¤éš¾åº¦æœªçŸ¥ï¼Œå¯èƒ½éœ€è¦å¤§é‡å·¥ä½œ
   - é€‚åˆä½œä¸ºå¤‡é€‰æ–¹æ¡ˆï¼Œä¸é€‚åˆä½œä¸ºé¦–é€‰

### 8.2 æœ€ç»ˆæ¨èæ–¹æ¡ˆ

**ä¸»æ–¹æ¡ˆï¼šQt WebEngineï¼ˆç½®ä¿¡åº¦ï¼š90%ï¼‰**

**ç†ç”±**ï¼š
- âœ… ç¤¾åŒºå·²éªŒè¯å¯è¡Œï¼ˆOxideæµè§ˆå™¨ï¼‰
- âœ… èµ„æºå ç”¨åœ¨å¯æ¥å—èŒƒå›´å†…
- âœ… å®Œæ•´çš„JavaScriptæ”¯æŒï¼Œæ— éœ€ä¿®æ”¹æºç 
- âœ… æˆç†Ÿçš„ç¦»çº¿ç¼“å­˜æŠ€æœ¯æ ˆ
- âœ… å¼€å‘å¤æ‚åº¦ä¸­ç­‰ï¼Œæœ‰ä¸°å¯Œå‚è€ƒèµ„æ–™
- âœ… æ»¡è¶³æ‰€æœ‰éœ€æ±‚ï¼šå®Œæ•´åŠŸèƒ½ + ç¦»çº¿æ”¯æŒ + ä¸­ç­‰å¤æ‚åº¦

**å¤‡é€‰æ–¹æ¡ˆï¼šLightpanda + ç®€åŒ–æ¸²æŸ“å±‚ï¼ˆç½®ä¿¡åº¦ï¼š60%ï¼‰**

**è§¦å‘æ¡ä»¶**ï¼š
- Qt WebEngineéªŒè¯å¤±è´¥ï¼ˆèµ„æºå ç”¨è¶…æ ‡æˆ–æ€§èƒ½ä¸è¶³ï¼‰
- æˆ–å¸Œæœ›è¿›ä¸€æ­¥ä¼˜åŒ–èµ„æºå ç”¨

### 8.3 ç«‹å³è¡ŒåŠ¨è®¡åˆ’

**ç¬¬1æ­¥ï¼šå¿«é€ŸéªŒè¯ï¼ˆ3-5å¤©ï¼‰**

```bash
# 1. è®¾ç½®å¼€å‘ç¯å¢ƒ
git clone https://github.com/Eeems/oxide.git
cd oxide/applications/web-app

# 2. ä¿®æ”¹main.cppï¼Œå°†ç›®æ ‡URLæ”¹ä¸ºå¾®ä¿¡è¯»ä¹¦
sed -i 's|loadUrl.*|loadUrl("https://weread.qq.com");|' main.cpp

# 3. äº¤å‰ç¼–è¯‘
mkdir build && cd build
cmake .. -DCMAKE_TOOLCHAIN_FILE=../remarkable-toolchain.cmake
make

# 4. éƒ¨ç½²åˆ°reMarkableæµ‹è¯•
scp web-app root@10.11.99.1:/opt/bin/src
ssh root@10.11.99.1 "/opt/bin/src"

# 5. æµ‹é‡èµ„æºå ç”¨
ssh root@10.11.99.1 "top -b -n 1 | grep weread"
```

**é¢„æœŸç»“æœ**ï¼š
- âœ… èƒ½æ‰“å¼€å¾®ä¿¡è¯»ä¹¦ç½‘é¡µ
- âœ… èƒ½æ­£å¸¸ç™»å½•ï¼ˆäºŒç»´ç æˆ–è´¦å·å¯†ç ï¼‰
- âœ… èƒ½æµè§ˆä¹¦æ¶å’Œé˜…è¯»ä¹¦ç±
- âœ… å†…å­˜å ç”¨ < 200MB
- âœ… å“åº”é€Ÿåº¦å¯æ¥å—

**å¦‚æœéªŒè¯æˆåŠŸ** â†’ è¿›å…¥å®Œæ•´å¼€å‘ï¼ˆé¢„è®¡4-6å‘¨ï¼‰
**å¦‚æœéªŒè¯å¤±è´¥** â†’ è½¬å‘Lightpandaæ–¹æ¡ˆ

**ç¬¬2æ­¥ï¼šå®Œæ•´å¼€å‘ï¼ˆ4-6å‘¨ï¼‰**

å‚è€ƒç¬¬4ç« çš„è¯¦ç»†å®æ–½è·¯å¾„ï¼š
- é˜¶æ®µ1ï¼šMVPéªŒè¯ï¼ˆ1å‘¨ï¼‰
- é˜¶æ®µ2ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆ2-3å‘¨ï¼‰
- é˜¶æ®µ3ï¼šç¦»çº¿ç³»ç»Ÿï¼ˆ1-2å‘¨ï¼‰
- é˜¶æ®µ4ï¼šä¼˜åŒ–å‘å¸ƒï¼ˆ1å‘¨ï¼‰

**ç¬¬3æ­¥ï¼šç¤¾åŒºå‘å¸ƒ**

- æ‰“åŒ…ä¸ºToltecåŒ…
- å‘å¸ƒåˆ°GitHub
- ç¼–å†™ç”¨æˆ·æ–‡æ¡£
- æ”¶é›†åé¦ˆå¹¶è¿­ä»£

### 8.4 å…³é”®æˆåŠŸå› ç´ 

1. **å°½å¿«éªŒè¯Qt WebEngine**ï¼šä¸è¦å†æµªè´¹æ—¶é—´åœ¨æœªéªŒè¯çš„å‡è®¾ä¸Š
2. **å¤ç”¨Oxideä»£ç **ï¼šç«™åœ¨å·¨äººçš„è‚©è†€ä¸Šï¼Œä¸è¦é‡å¤é€ è½®å­
3. **åˆ†é˜¶æ®µå®æ–½**ï¼šæ¯ä¸ªé˜¶æ®µéƒ½æœ‰æ˜ç¡®çš„éªŒè¯ç›®æ ‡
4. **å‡†å¤‡å¤‡é€‰æ–¹æ¡ˆ**ï¼šå¦‚æœä¸»æ–¹æ¡ˆå¤±è´¥ï¼Œå¿«é€Ÿåˆ‡æ¢åˆ°Lightpanda

### 8.5 é¢„æœŸæˆæœ

**æŠ€æœ¯æˆæœ**ï¼š
- ä¸€ä¸ªåŠŸèƒ½å®Œæ•´çš„å¾®ä¿¡è¯»ä¹¦reMarkableåº”ç”¨
- æ”¯æŒç™»å½•ã€ä¹¦æ¶ã€é˜…è¯»ã€æ”¶è´¹ç« èŠ‚
- æ™ºèƒ½ç¦»çº¿ç¼“å­˜ï¼Œæ”¯æŒåœ°é“é˜…è¯»åœºæ™¯
- é’ˆå¯¹E-Inkä¼˜åŒ–çš„æ˜¾ç¤ºæ•ˆæœ

**ç¤¾åŒºä»·å€¼**ï¼š
- ä¸ºreMarkableæä¾›ä¸€ä¸ªä¼˜è´¨çš„é˜…è¯»åº”ç”¨
- ä¸ºå…¶ä»–Webåº”ç”¨ç§»æ¤æä¾›å‚è€ƒ
- æ¨åŠ¨reMarkableç”Ÿæ€å‘å±•

**ä¸ªäººæ”¶è·**ï¼š
- æ·±å…¥ç†è§£Qt WebEngine
- æŒæ¡E-Inkä¼˜åŒ–æŠ€æœ¯
- å­¦ä¹ ARMäº¤å‰ç¼–è¯‘
- ç§¯ç´¯åµŒå…¥å¼å¼€å‘ç»éªŒ

### 8.6 æ–‡æ¡£æ”¹è¿›æ€»ç»“

**æœ¬æ¬¡æ›´æ–°çš„å…³é”®æ”¹è¿›**ï¼š

1. âœ… æ·»åŠ äº†è¯¦ç»†çš„æ–¹æ¡ˆå¯¹æ¯”çŸ©é˜µ
2. âœ… é‡æ–°è¯„ä¼°Qt WebEngineï¼Œçº æ­£ä¹‹å‰çš„è¯¯åˆ¤
3. âœ… è¡¥å……äº†Oxideæµè§ˆå™¨çš„å®æµ‹æ•°æ®
4. âœ… æä¾›äº†å®Œæ•´çš„Qt WebEngineå®ç°ä»£ç 
5. âœ… æ·±åº¦è°ƒç ”äº†ç¤¾åŒºèµ„æºå’ŒæŠ€æœ¯ç»†èŠ‚
6. âœ… åˆ†æäº†å¾®ä¿¡è¯»ä¹¦çš„WebæŠ€æœ¯æ ˆ
7. âœ… è®¾è®¡äº†ä¸‰å±‚ç¦»çº¿ç¼“å­˜ç­–ç•¥
8. âœ… æ˜ç¡®äº†ç«‹å³å¯æ‰§è¡Œçš„è¡ŒåŠ¨è®¡åˆ’

**ä»éœ€è¡¥å……çš„å†…å®¹**ï¼ˆå¯é€‰ï¼‰ï¼š

1. å®é™…åœ¨reMarkableä¸Šçš„æµ‹è¯•æŠ¥å‘Š
2. ä¸å¾®ä¿¡è¯»ä¹¦å›¢é˜Ÿçš„æ²Ÿé€šç»“æœï¼ˆå¦‚æœæœ‰ï¼‰
3. å®Œæ•´çš„ç”¨æˆ·æ“ä½œæ‰‹å†Œ
4. æ€§èƒ½åŸºå‡†æµ‹è¯•æ•°æ®
5. é•¿æœŸç»´æŠ¤è®¡åˆ’

### 8.7 æœ€ç»ˆå»ºè®®

**ç»™é¡¹ç›®å¼€å‘è€…çš„å»ºè®®**ï¼š

1. **ç«‹å³è¡ŒåŠ¨**ï¼šåœæ­¢ç»§ç»­ç ”ç©¶ï¼Œå¼€å§‹å®é™…éªŒè¯Qt WebEngine
2. **é™ä½æœŸæœ›**ï¼šç¬¬ä¸€ç‰ˆå¯ä»¥åŠŸèƒ½ç®€å•ï¼Œé‡ç‚¹æ˜¯éªŒè¯å¯è¡Œæ€§
3. **å¿«é€Ÿè¿­ä»£**ï¼šæ¯å‘¨éƒ½åº”è¯¥æœ‰å¯æµ‹è¯•çš„è¿›å±•
4. **å¯»æ±‚å¸®åŠ©**ï¼šè”ç³»Oxideé¡¹ç›®ç»´æŠ¤è€…ï¼Œå­¦ä¹ ä»–ä»¬çš„ç»éªŒ
5. **ä¿æŒç°å®**ï¼šå¦‚æœé‡åˆ°æ— æ³•å…‹æœçš„æŠ€æœ¯éšœç¢ï¼ŒåŠæ—¶è°ƒæ•´æ–¹æ¡ˆ

**ç»™å…¶ä»–å¼€å‘è€…çš„å¯ç¤º**ï¼š

1. ä¸è¦è¿‡æ—©ä¼˜åŒ–æˆ–æ’é™¤æ–¹æ¡ˆ
2. å®é™…æµ‹è¯•èƒœè¿‡ç†è®ºåˆ†æ
3. å……åˆ†åˆ©ç”¨å¼€æºç¤¾åŒºçš„æˆæœ
4. åˆ†é˜¶æ®µéªŒè¯ï¼Œé™ä½é£é™©
5. ä¿æŒçµæ´»ï¼Œå‡†å¤‡å¤‡é€‰æ–¹æ¡ˆ

---

**æœ¬é¡¹ç›®æ˜¯å¯è¡Œçš„**ã€‚é€šè¿‡Qt WebEngineæ–¹æ¡ˆï¼Œåœ¨4-6å‘¨å†…å®Œå…¨å¯ä»¥å®ç°ä¸€ä¸ªåŠŸèƒ½å®Œæ•´ã€ä½“éªŒè‰¯å¥½çš„å¾®ä¿¡è¯»ä¹¦reMarkableåº”ç”¨ã€‚å…³é”®æ˜¯**ç«‹å³å¼€å§‹éªŒè¯ï¼Œè€Œä¸æ˜¯ç»§ç»­è§„åˆ’**ã€‚

## 9. Phase B å®æ–½è®¡åˆ’ï¼ˆ2025å¹´11æœˆ-12æœˆï¼‰

Phase B ä»¥"è¡¥é½ Qt6 WebEngine å¹¶åœ¨è®¾å¤‡ä¸Šç¨³å®šè¿è¡Œå¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆ"ä¸ºæ ¸å¿ƒç›®æ ‡ï¼ŒåŒæ—¶ä¿ç•™ Qt5 è¿è¡Œæ—¶ä½œä¸ºå®‰å…¨å…œåº•è·¯å¾„ã€‚

### 9.1 æ ¸å¿ƒç›®æ ‡

- **G1ï½œåŸç”Ÿ Qt6 æµè§ˆå™¨é“¾è·¯**ï¼šæ„å»ºå¹¶éƒ¨ç½² Qt6.8.2 WebEngineï¼Œä¸ç³»ç»Ÿ epaper æ’ä»¶æ•´åˆï¼Œè·‘é€šæµè§ˆå™¨ä¸»æµç¨‹ã€‚
- **G2ï½œæ€§èƒ½ä¸ç¨³å®šæ€§åŸºçº¿**ï¼šåœ¨è®¾å¤‡ä¸Šå®æµ‹é¡µé¢åˆ·æ–°ã€è¾“å…¥å»¶è¿Ÿã€å†…å­˜å ç”¨ï¼Œå½¢æˆå¯å¤ç”¨çš„æµ‹è¯•è„šæœ¬ä¸æŒ‡æ ‡ã€‚
- **G3ï½œPhase B æ–‡æ¡£äº¤ä»˜**ï¼šæ²‰æ·€æ„å»ºè„šæœ¬ã€éƒ¨ç½²æµç¨‹ã€é—®é¢˜æ’æŸ¥æŒ‡å—ï¼Œæ›´æ–° AppLoad å‘å¸ƒæµç¨‹ã€‚

### 9.2 é‡Œç¨‹ç¢‘ç”˜ç‰¹

| é‡Œç¨‹ç¢‘ | æ—¶é—´çª—å£ | è´Ÿè´£äºº | æ ¸å¿ƒäº§å‡º |
|--------|----------|--------|----------|
| **B0ï¼šPhase A ç»“æœå¤æ ¸** | 11.11 - 11.12 | @jameszhu | è®¾å¤‡æ—¥å¿—ã€æ˜¾ç¤ºæˆªå›¾ã€éªŒè¯è®°å½•æ•´ç†åˆ° `src/logs/phaseA/` |
| **B1ï¼šQt6 WebEngine ç¼–è¯‘é“¾è·¯æ‰“é€š** | 11.13 - 11.17 | @jameszhu | `scripts/build-qt6-webengine.sh`ã€`scripts/toolchain-env.sh` å¯é‡å¤æ‰§è¡Œ |
| **B2ï¼šè®¾å¤‡ç«¯æœ€å°æ ·ä¾‹è¿è¡Œ** | 11.18 - 11.22 | @jameszhu | `weread-qt6` demo åœ¨ epaper æ¨¡å¼ä¸‹ç¨³å®šæ˜¾ç¤º 10 åˆ†é’Ÿã€è®°å½•èµ„æºå ç”¨ |
| **B3ï¼šå¾®ä¿¡è¯»ä¹¦æ ¸å¿ƒæµç¨‹éªŒè¯** | 11.23 - 11.29 | @jameszhu | ç™»å½•ï¼ˆæ‰«ç ï¼‰ã€æ‰“å¼€ä¹¦æ¶ã€é˜…è¯»ç« èŠ‚ï¼ˆå«æ”¶è´¹ç« èŠ‚ï¼‰å…¨æµç¨‹å½•åƒä¸æ—¥å¿— |
| **B4ï¼šç¦»çº¿ç¼“å­˜ä¸è¾“å…¥ä¼˜åŒ–** | 11.30 - 12.06 | @jameszhu | è¾“å…¥æ‰‹åŠ¿æ˜ å°„ã€ç¼“å­˜ç­–ç•¥åˆç‰ˆã€åˆ·æ–°ç­–ç•¥é…ç½®æ–‡ä»¶ |
| **B5ï¼šå‘å¸ƒå€™é€‰ç‰ˆ** | 12.07 - 12.13 | @jameszhu | AppLoad åŒ…ã€å‡çº§æŒ‡å—ã€å›æ»šæ–¹æ¡ˆã€Phase B æˆæœæŠ¥å‘Š |

> æ—¶é—´çª—å£ä¸ºå·¥ä½œæ—¥ä¼°ç®—ï¼Œå¯æ ¹æ®å®é™…è¿›åº¦å¹¶è¡Œè°ƒæ•´ï¼›è‹¥ B1/B2 å—é˜»ï¼Œå¯ç«‹å³åˆ‡æ¢è‡³ Qt5 å¤‡ç”¨è·¯å¾„ï¼ŒåŒæ­¥æ›´æ–°é‡Œç¨‹ç¢‘ã€‚

### 9.3 å·¥ä½œåˆ†è§£ç»“æ„ï¼ˆWBSï¼‰

- **B0 ç¯å¢ƒæ”¶æ•›**
  - æ”¶é›† Phase A è¿è¡Œæ—¥å¿—ä¸æˆªå›¾ï¼Œæ›´æ–° `src/PHASE_A_SUCCESS_REPORT.md`
  - æ•´ç†è®¾å¤‡ç¯å¢ƒå·®å¼‚ï¼ˆå›ºä»¶ç‰ˆæœ¬ã€ç³»ç»Ÿåº“åˆ—è¡¨ï¼‰ï¼Œé”å®šåŸºçº¿
- **B1 å·¥å…·é“¾ä¸æ„å»º**
  - ç¼–å†™ `scripts/toolchain-env.sh` ç»Ÿä¸€å¯¼å‡ºäº¤å‰ç¼–è¯‘å˜é‡
  - å¤ç”¨å®˜æ–¹ SDKï¼Œåˆ¶ä½œ `cmake/toolchain-remarkable.cmake`
  - è°ƒæ•´ Qt6 é…ç½®å‚æ•°ï¼Œç”Ÿæˆæœ€å° WebEngine åŠŸèƒ½é›†
- **B2 éƒ¨ç½²ä¸éªŒè¯**
  - æ–°å¢ `scripts/deploy-qt6-webengine.sh`ï¼Œè‡ªåŠ¨æ‰“åŒ… Qt6 è¿è¡Œæ—¶ä»£ç 
  - åœ¨è®¾å¤‡ä¸Šè¿è¡Œ demoï¼Œè®°å½• `journalctl`ã€`QSG_INFO`ã€`QT_DEBUG_PLUGINS`
  - ç¼–å†™ `tests/manual/phaseB-smoke.md` æ‰‹å·¥éªŒè¯æ¸…å•
- **B3 åŠŸèƒ½å¢å¼º**
  - æ¥å…¥ `qtfb-shim`ï¼Œå®ç°ç¬”/è§¦æ§äº‹ä»¶ä¸å¿«æ·é”®æ˜ å°„
  - æ³¨å…¥ CSS/JS ä¼˜åŒ– E-Ink è¡Œä¸ºï¼ˆç¦åŠ¨ç”»ã€å¢å¼ºå¯¹æ¯”åº¦ï¼‰
  - å®ç°ç™»å½•æ€ä¿æŒä¸ç¼“å­˜ç›®å½•éš”ç¦»
- **B4 æ–‡æ¡£ä¸å‘å¸ƒ**
  - æ›´æ–° `README.md` Phase B æ­¥éª¤ä¸ FAQ
  - è¾“å‡º `src/reports/phaseB/` å†…å­˜ã€åˆ·æ–°ã€åŠŸè€—æµ‹è¯•æŠ¥å‘Š
  - å‡†å¤‡ AppLoad Manifest ä¸å›æ»šè„šæœ¬

### 9.4 éªŒæ”¶æ ‡å‡†

- âœ… Qt6 WebEngine demo åœ¨è®¾å¤‡ä¸Šè¿è¡Œ â‰¥30 åˆ†é’Ÿï¼Œæ— å´©æºƒã€æ— æ˜æ˜¾æ®‹å½±ã€‚
- âœ… å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆå¯å®Œæˆç™»å½•ã€ä¹¦æ¶åŠ è½½ã€ç¦»çº¿é˜…è¯»ï¼ˆå·²ç¼“å­˜ç« èŠ‚ï¼‰ã€‚
- âœ… å…³é”®æŒ‡æ ‡è¾¾æ ‡ï¼šå†…å­˜å³°å€¼ < 220MBï¼Œè§¦æ§å“åº” < 500msï¼Œæ•´é¡µåˆ·æ–° < 800msã€‚
- âœ… æ‰€æœ‰è„šæœ¬å‡åœ¨ CI/æœ¬åœ°æ¨¡æ‹Ÿç¯å¢ƒè·‘é€šï¼ˆ`./ci/phaseB-smoke.sh`ï¼‰ã€‚
- âœ… Phase B æŠ¥å‘Šã€FAQã€æ•…éšœæ’æŸ¥æ‰‹å†Œåˆå¹¶å…¥ä»“åº“ã€‚

### 9.5 Phase B ç‰¹æœ‰é£é™©ä¸åº”å¯¹

| é£é™© | æè¿° | é¢„é˜²æªæ–½ | è§¦å‘é˜ˆå€¼ | åº”æ€¥æ–¹æ¡ˆ |
|------|------|----------|----------|----------|
| Qt6 WebEngine ç¼–è¯‘å¤±è´¥ | LLVM/Node å·¥å…·é“¾ä¾èµ–åºå¤§ | é¢„å…ˆä¸‹è½½ç¦»çº¿ä¾èµ–ï¼Œä½¿ç”¨å®¹å™¨é”å®šç‰ˆæœ¬ | è¿ç»­ç¼–è¯‘å¤±è´¥ 2 å¤© | å¯ç”¨ Qt5 è¿è¡Œæ—¶å…œåº•ï¼Œä¿ç•™ Phase B å…¶ä»–å·¥ä½œ |
| WebEngine è½¯ä»¶æ¸²æŸ“æ€§èƒ½ä¸è¶³ | é¡µé¢æ»šåŠ¨ã€è§†é¢‘è§£ç å¡é¡¿ | ç¦ç”¨ GPUã€åŠ¨ç”»ï¼Œé‡‡ç”¨å±€éƒ¨åˆ·æ–° | é¡µé¢æ»šåŠ¨å¸§ç‡ < 2fps | å¯ç”¨æ®µè½åˆ†é¡µæ¨¡å¼ã€å¼ºåˆ¶ A2 åˆ·æ–° |
| è¾“å…¥äº‹ä»¶æ¼‚ç§»æˆ–ä¸¢å¤± | qtfb-shim ä¸ Qt6 æ¥å£å·®å¼‚ | åœ¨ B2 é˜¶æ®µå®Œæˆè¾“å…¥æµ‹è¯•çŸ©é˜µ | è§¦æ§å¤±æ•ˆç‡ > 5% | å›é€€ Qt5/NetSurf è¾“å…¥æ¨¡å—ï¼Œå®ç°äº‹ä»¶è½¬å‘ |
| å†…å­˜å ç”¨è¶…æ ‡ | WebEngine ç¼“å­˜å¯¼è‡´å†…å­˜æ¶¨åˆ° 220MB ä»¥ä¸Š | é™åˆ¶ç¼“å­˜ã€å¼€å¯å®šæœŸæ¸…ç† | è¿ç»­ 3 æ¬¡è¶…è¿‡ 220MB | é™çº§åŠ è½½æ¨¡å¼ï¼Œå…³é—­å›¾ç‰‡/è„šæœ¬ç¼“å­˜ |
| æ³•å¾‹æ¡æ¬¾å˜æ›´ | å¾®ä¿¡è¯»ä¹¦æˆ– reMarkable æ”¿ç­–æ›´æ–° | è·Ÿè¿›å®˜ç½‘ä¸ç¤¾åŒºå…¬å‘Š | å‘ç°æ¡æ¬¾ç¦ç”¨ç¬¬ä¸‰æ–¹å®¢æˆ·ç«¯ | æš‚åœ Phase B å‘å¸ƒï¼Œä¿ç•™å†…éƒ¨æµ‹è¯• |

### 9.6 äº¤ä»˜ç‰©æ¸…å•

- `scripts/build-qt6-webengine.sh`ã€`scripts/deploy-qt6-webengine.sh`
- `cmake/toolchain-remarkable.cmake`ã€`scripts/toolchain-env.sh`
- `tests/manual/phaseB-smoke.md`ã€`reports/phaseB/perf-baseline.md`
- `deploy/appload/weread-browser-qt6/`ï¼ˆmanifestã€å¯åŠ¨è„šæœ¬ã€å›æ»šè„šæœ¬ï¼‰
- `PHASE_B_PROGRESS.md`ï¼ˆå‘¨æŠ¥å¼è¿›åº¦è¿½è¸ªï¼‰

> Phase B ç»“æŸåï¼Œå°†è¿›å…¥ Phase Cï¼ˆåŠŸèƒ½å®Œå–„ä¸ç¦»çº¿å¢å¼ºï¼‰ï¼Œå±Šæ—¶ä¼šåŸºäºä¸Šè¿°äº¤ä»˜ç‰©ç»§ç»­æ‰©å±•ã€‚

## é™„å½•A: NetSurfå®ç°è¯¦ç»†æŒ‡å—

### A.1 å®‰è£…ä¸é…ç½®

#### æ–‡ä»¶ç»“æ„
```
/opt/bin/netsurf                                    # NetSurf ä¸»ç¨‹åº (9.2 MB)
/opt/lib/
â”œâ”€â”€ libjpeg.so.8                                    # JPEG åº“
â”œâ”€â”€ libevdev.so.2                                   # è¾“å…¥è®¾å¤‡åº“
â””â”€â”€ libudev.so.1                                    # è®¾å¤‡ç®¡ç†åº“

/opt/share/fonts/noto-cjk/
â””â”€â”€ NotoSansCJK-Regular.ttc                         # ä¸­æ–‡å­—ä½“ (13.8 MB)

/home/root/xovi/exthome/appload/netsurf/
â”œâ”€â”€ netsurf.sh                                      # å¯åŠ¨è„šæœ¬
â”œâ”€â”€ external.manifest.json                          # AppLoad æ¸…å•
â””â”€â”€ icon.png                                        # åº”ç”¨å›¾æ ‡

/home/root/.netsurf/
â””â”€â”€ Choices                                         # NetSurf é…ç½®
```

#### AppLoadé…ç½® (external.manifest.json)
```json
{
  "name": "NetSurf",
  "application": "netsurf.sh",
  "environment": {
    "LD_PRELOAD": "/home/root/shims/qtfb-shim.so",
    "QTFB_SHIM_MODEL": "false",
    "QTFB_SHIM_INPUT_MODE": "INJECT",
    "QTFB_SHIM_MODE": "N_RGB565"
  },
  "qtfb": true
}
```

### A.2 å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

#### é—®é¢˜1: JavaScriptæ”¯æŒä¸å®Œæ•´å¯¼è‡´æ— æ³•ç™»å½•
**ç—‡çŠ¶**: æ— æ³•æ˜¾ç¤ºç™»å½•äºŒç»´ç ï¼Œä¹¦ç±å†…å®¹æ— æ³•æ­£å¸¸æ˜¾ç¤º
**è§£å†³æ–¹æ¡ˆ**:
1. è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹:
   ```bash
   ssh root@10.11.99.1
   sed -i 's/scale:120/scale:100/' /home/root/.netsurf/Choices
   ```
2. å°è¯•ç¦ç”¨JavaScriptæµ‹è¯•åŸºæœ¬åŠŸèƒ½:
   ```bash
   sed -i 's/enable_javascript:1/enable_javascript:0/' /home/root/.netsurf/Choices
   ```
3. è€ƒè™‘ä½¿ç”¨æ›´å®Œæ•´çš„æµè§ˆå™¨å¼•æ“(å¦‚Qt WebEngine)

#### é—®é¢˜2: é¡µé¢æ˜¾ç¤ºä¸å…¨
**ç—‡çŠ¶**: é¡µé¢å†…å®¹æ˜¾ç¤ºä¸å®Œæ•´æˆ–æ’ç‰ˆå¼‚å¸¸
**è§£å†³æ–¹æ¡ˆ**:
1. è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹(80-120ä¹‹é—´):
   ```ini
   scale:100   # é»˜è®¤ç¼©æ”¾
   # æˆ–
   scale:80    # æ˜¾ç¤ºæ›´å¤šå†…å®¹ï¼Œå­—ä½“è¾ƒå°
   ```
2. è°ƒæ•´å·¥å…·æ å¤§å°:
   ```ini
   fb_toolbar_size:40      # å‡å°å·¥å…·æ 
   fb_furniture_size:30    # å‡å°UIå…ƒç´ 
   ```

#### é—®é¢˜3: ä¸­æ–‡æ˜¾ç¤ºä¸ºæ–¹å—
**ç—‡çŠ¶**: ä¸­æ–‡å­—ç¬¦æ˜¾ç¤ºä¸ºæ–¹å—æˆ–ä¹±ç 
**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿ä¸­æ–‡å­—ä½“å·²å®‰è£…:
   ```bash
   # æ£€æŸ¥å­—ä½“æ–‡ä»¶æ˜¯å¦å­˜åœ¨
   ls -la /opt/share/fonts/noto-cjk/NotoSansCJK-Regular.ttc
   ```
2. æ›´æ–°å­—ä½“é…ç½®:
   ```ini
   fb_face_sans_serif:/opt/share/fonts/noto-cjk/NotoSansCJK-Regular.ttc
   fb_face_sans_serif_bold:/opt/share/fonts/noto-cjk/NotoSansCJK-Regular.ttc
   fb_face_sans_serif_italic:/opt/share/fonts/noto-cjk/NotoSansCJK-Regular.ttc
   ```

### A.3 æ€§èƒ½ä¼˜åŒ–å»ºè®®

---

## é™„å½•B: å¾®ä¿¡è¯»ä¹¦ Qt WebEngine AppLoad æ‰“åŒ…

åœ¨å®Œæˆ `./deploy/deploy.sh`ï¼ˆæ‹·è´ Qt5 è¿è¡Œæ—¶ä¸ `weread-browser` å¯æ‰§è¡Œæ–‡ä»¶ï¼‰ä¹‹åï¼Œå¯ç›´æ¥æŠŠ Qt WebEngine ç‰ˆæœ¬çš„å¾®ä¿¡è¯»ä¹¦æŒ‚è½½åˆ° AppLoadã€‚ä»“åº“å·²ç»å‡†å¤‡å¥½å®Œæ•´çš„ AppLoad ç›®å½•ï¼š

```
src/deploy/appload/weread-browser/
â”œâ”€â”€ external.manifest.json    # AppLoad æè¿°æ–‡ä»¶
â”œâ”€â”€ icon.png                  # "å¢¨æ°´ç“¶"é£æ ¼å›¾æ ‡ï¼ˆ256x256ï¼Œé€‚é… E-Inkï¼‰
â””â”€â”€ weread-appload.sh         # å…¥å£è„šæœ¬ï¼Œè´Ÿè´£è®¾ç½® Qt5 è¿è¡Œæ—¶ç¯å¢ƒ
```

`external.manifest.json` å…³é”®å­—æ®µå¦‚ä¸‹ï¼š

```json
{
  "id": "weread-browser",
  "name": "å¾®ä¿¡è¯»ä¹¦",
  "application": "weread-appload.sh",
  "workingDirectory": "/home/root/xovi/exthome/appload/weread-browser",
  "environment": {
    "LD_PRELOAD": "/home/root/shims/qtfb-shim.so",
    "QTFB_SHIM_MODE": "N_RGB565",
    "QTFB_SHIM_INPUT_MODE": "RMPPM",
    "QTFB_SHIM_MODEL": "0",
    "QTFB_SHIM_CURSOR": "1"
  },
  "qtfb": true,
  "aspectRatio": "move",
  "icon": "icon.png"
}
```

> è¯´æ˜ï¼š`QTFB_SHIM_*` é…ç½®ç¡®ä¿ qtfb-shim æ ¹æ® Paper Pro Move çš„åˆ†è¾¨ç‡ä¸åæ ‡ç³»è¿›è¡Œè½¬æ¢ï¼›`qtfb: true` è®© AppLoad ä»¥ qtfb è™šæ‹Ÿå¸§ç¼“å†²æ–¹å¼è¿è¡Œï¼Œæ— éœ€åœæ­¢ç³»ç»Ÿ UIã€‚

### B.1 æ¨é€åˆ°è®¾å¤‡

æ‰§è¡Œæ–°çš„éƒ¨ç½²è„šæœ¬å³å¯è‡ªåŠ¨æ‹·è´ manifestã€å…¥å£è„šæœ¬ä¸å›¾æ ‡ï¼Œå¹¶åˆ·æ–° AppLoad å“ˆå¸Œè¡¨ï¼š

```bash
cd src
./deploy/deploy-appload.sh            # USB é»˜è®¤ 10.11.99.1
# æˆ–è‡ªå®šä¹‰ IP
# ./deploy/deploy-appload.sh 192.168.x.x
```

è„šæœ¬ä¼šï¼š
1. æŠŠç›®å½•å¤åˆ¶åˆ° `/home/root/xovi/exthome/appload/weread-browser`
2. ä¸º `weread-appload.sh` åŠ æ‰§è¡Œæƒé™
3. è¿è¡Œ `/home/root/xovi/rebuild_hashtable` å¹¶é‡å¯ `xochitl`

å¦‚æœä¸æƒ³é‡å¯ç³»ç»Ÿ UIï¼Œå¯æ‰‹åŠ¨æ‰§è¡Œï¼š

```bash
ssh root@10.11.99.1 "/home/root/xovi/rebuild_hashtable"
ssh root@10.11.99.1 "/home/root/xovi/start"      # æˆ–è¿ç»­æŒ‰ä¸‰æ¬¡ç”µæºé”®
```

### B.2 å…¥å£è„šæœ¬è¦ç‚¹

`weread-appload.sh` ä¼šåœ¨ AppLoad ç¯å¢ƒä¸­å®Œæˆä»¥ä¸‹å‡†å¤‡ï¼š

- æŒ‡å‘ `/home/qt5rt` çš„ Qt5 ç§æœ‰è¿è¡Œæ—¶ï¼ˆ`LD_LIBRARY_PATH`ã€`QT_PLUGIN_PATH`ã€`QML2_IMPORT_PATH` ç­‰ï¼‰
- åˆå§‹åŒ– NSS è¯ä¹¦ç›®å½•ï¼Œä¿è¯ Qt WebEngine çš„ HTTPS / WebSocket æ­£å¸¸å·¥ä½œ
- è®¾å®š `QT_QPA_PLATFORM=linuxfb` + çº¯è½¯ä»¶æ¸²æŸ“å‚æ•°ï¼Œå¹¶å¯ç”¨è§¦æ‘¸/æ‰‹å†™ç¬”äº‹ä»¶
- é»˜è®¤æ‰“å¼€ `https://weread.qq.com/web`ï¼Œä¹Ÿå¯é€šè¿‡ manifest `args` ä¼ å…¥å…¶å®ƒ URL

å› æ­¤ç”¨æˆ·åªéœ€è¦ä¿æŒ `/home/qt5rt` ä¸ `/home/weread-app/weread-browser` ä¸ºæœ€æ–°ç‰ˆæœ¬ï¼Œå³å¯é€šè¿‡ AppLoad ä¾§è¾¹æ å¯åŠ¨"å¾®ä¿¡è¯»ä¹¦"ï¼Œå›¾æ ‡ä¸ºå¢¨æ°´å±é£æ ¼çš„å¾®ä¿¡è¯»ä¹¦å¢¨æ°´ç“¶ã€‚

1. **å‡å°‘ç¼©æ”¾æé«˜æ€§èƒ½**:
   ```ini
   scale:100
   ```

2. **ç®€åŒ–å·¥å…·æ **:
   ```ini
   fb_toolbar_size:40
   fb_furniture_size:30
   ```

3. **ç¦ç”¨å›¾ç‰‡(å¦‚ä¸éœ€è¦)**:
   ```ini
   # åœ¨ç¼–è¯‘æ—¶è®¾ç½®
   # NETSURF_USE_JPEG := NO
   ```

4. **é’ˆå¯¹é˜…è¯»ä¼˜åŒ–**:
   ```ini
   scale:110                        # èˆ’é€‚çš„å­—ä½“å¤§å°
   homepage_url: https://weread.qq.com/web/reader   # ç›´æ¥è¿›å…¥é˜…è¯»å™¨
   ```

### A.4 JavaScriptæ”¯æŒé—®é¢˜çš„è§£å†³æ–¹æ¡ˆ

#### é—®é¢˜åˆ†æ
NetSurfæµè§ˆå™¨è™½ç„¶è½»é‡çº§ä¸”é€‚åˆreMarkableè®¾å¤‡ï¼Œä½†å…¶JavaScriptå¼•æ“æ”¯æŒä¸å®Œæ•´ï¼Œå¯¼è‡´æ— æ³•æ˜¾ç¤ºç™»å½•äºŒç»´ç å’Œéƒ¨åˆ†ä¹¦ç±å†…å®¹ã€‚è¿™æ˜¯å®ç°å®Œæ•´å¾®ä¿¡è¯»ä¹¦åŠŸèƒ½çš„ä¸»è¦éšœç¢ã€‚

#### è§£å†³æ–¹æ¡ˆå¯¹æ¯”

##### æ–¹æ¡ˆA: é›†æˆæ›´å®Œæ•´çš„JavaScriptå¼•æ“(å¦‚Qt WebEngine)
**ä¼˜ç‚¹**:
- å®Œæ•´æ”¯æŒç°ä»£JavaScriptæ ‡å‡†
- ä¸Qtæ¡†æ¶é›†æˆè‰¯å¥½
- ç¤¾åŒºæ”¯æŒå¹¿æ³›

**ç¼ºç‚¹**:
- èµ„æºå ç”¨è¾ƒå¤§(å¯èƒ½è¶…è¿‡è®¾å¤‡é™åˆ¶)
- ç¼–è¯‘å’Œç§»æ¤å¤æ‚åº¦é«˜

**å®ç°æ­¥éª¤**:
1. è¯„ä¼°reMarkableè®¾å¤‡èµ„æºæ˜¯å¦æ»¡è¶³Qt WebEngineéœ€æ±‚
2. é…ç½®äº¤å‰ç¼–è¯‘ç¯å¢ƒï¼Œç¼–è¯‘Qt WebEngine
3. æ›¿æ¢NetSurfçš„æ¸²æŸ“å¼•æ“ä¸ºQt WebEngine
4. é€‚é…reMarkableçš„è¾“å…¥ç³»ç»Ÿå’Œæ˜¾ç¤ºç‰¹æ€§

##### æ–¹æ¡ˆB: å®ç°å¾®ä¿¡è¯»ä¹¦APIçš„ç›´æ¥è°ƒç”¨
**ä¼˜ç‚¹**:
- ç»•è¿‡JavaScripté™åˆ¶
- å¯èƒ½æ›´è½»é‡çº§
- æ›´å¥½çš„ç¦»çº¿æ”¯æŒ

**ç¼ºç‚¹**:
- éœ€è¦é€†å‘åˆ†æå¾®ä¿¡è¯»ä¹¦API
- APIå¯èƒ½å˜æ›´ï¼Œç»´æŠ¤æˆæœ¬é«˜
- å¯èƒ½è¿åå¾®ä¿¡è¯»ä¹¦æœåŠ¡æ¡æ¬¾

**å®ç°æ­¥éª¤**:
1. åˆ†æå¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆAPIè°ƒç”¨(å·²å‘ç°çš„ä¸»è¦API):
   - ç™»å½•æ¥å£: "https://i.weread.qq.com/user/notebooks"
   - ä¹¦æ¶åŒæ­¥: "https://i.weread.qq.com/shelf/sync?userVid=" + userVid
   - ä¹¦ç±å†…å®¹è·å–: éœ€è¦è¿›ä¸€æ­¥åˆ†æ
2. å®ç°æœ¬åœ°APIå®¢æˆ·ç«¯ï¼Œå¤„ç†è®¤è¯å’Œæ•°æ®è·å–
3. å¼€å‘æœ¬åœ°æ¸²æŸ“å¼•æ“ï¼Œå°†è·å–çš„å†…å®¹é€‚é…åˆ°ç”µå­å¢¨æ°´å±
4. å®ç°åŸºæœ¬çš„äº¤äº’åŠŸèƒ½(ç¿»é¡µã€æ ‡æ³¨ç­‰)

##### æ–¹æ¡ˆC: å¼€å‘æ··åˆæ¸²æŸ“æ–¹æ¡ˆ
**ä¼˜ç‚¹**:
- å¹³è¡¡åŠŸèƒ½å®Œæ•´æ€§å’Œèµ„æºå ç”¨
- å¯ä»¥é€æ­¥å®ç°
- å…³é”®åŠŸèƒ½ä¼˜å…ˆä¿è¯

**ç¼ºç‚¹**:
- å®ç°å¤æ‚åº¦é«˜
- éœ€è¦å¤„ç†ä¸¤ç§æ¸²æŸ“æ–¹å¼çš„åè°ƒ

**å®ç°æ­¥éª¤**:
1. è¯†åˆ«å¾®ä¿¡è¯»ä¹¦çš„å…³é”®åŠŸèƒ½(ç™»å½•ã€ä¹¦ç±åˆ—è¡¨ã€é˜…è¯»)
2. å¯¹å…³é”®åŠŸèƒ½ä½¿ç”¨æœ¬åœ°APIå®ç°(æ–¹æ¡ˆB)
3. å¯¹éå…³é”®åŠŸèƒ½ä¿ç•™NetSurfæ¸²æŸ“
4. å¼€å‘åˆ‡æ¢æœºåˆ¶ï¼Œæ ¹æ®åœºæ™¯é€‰æ‹©æ¸²æŸ“æ–¹å¼

##### æ–¹æ¡ˆD: æ›¿æ¢NetSurfçš„JavaScriptå¼•æ“ä¸ºè½»é‡çº§æ›¿ä»£æ–¹æ¡ˆ
**ä¼˜ç‚¹**:
- ä¿æŒNetSurfè½»é‡çº§ç‰¹æ€§
- æå‡JavaScriptæ”¯æŒ
- ç›¸å¯¹è¾ƒä½çš„å®ç°å¤æ‚åº¦

**ç¼ºç‚¹**:
- éœ€è¦æ·±å…¥NetSurfå†…éƒ¨ç»“æ„
- å¯èƒ½å­˜åœ¨å…¼å®¹æ€§é—®é¢˜

**æ¨èå¼•æ“é€‰æ‹©**:
1. **QuickJS** <mcreference link="https://blog.51cto.com/u_16213379/12669010" index="1">1</mcreference>:
   - è¶…è½»é‡çº§(çº¦367 KiB)
   - æ”¯æŒES2020+æ ‡å‡†
   - å¯åŠ¨å¿«ï¼Œå†…å­˜å ç”¨ä½
   - é€‚åˆåµŒå…¥å¼ç³»ç»Ÿ

2. **Duktape** <mcreference link="https://www.cnblogs.com/yasepix/p/12340908.html" index="4">4</mcreference>:
   - å¯åœ¨256kBé—ªå­˜å’Œ64kB RAMä¸Šè¿è¡Œ
   - å…¼å®¹ECMAScript E5/E5.1æ ‡å‡†
   - æ˜“äºé›†æˆåˆ°C/C++é¡¹ç›®
   - å†…ç½®è°ƒè¯•å™¨å’Œæ­£åˆ™è¡¨è¾¾å¼å¼•æ“

**å®ç°æ­¥éª¤**:
1. é€‰æ‹©åˆé€‚çš„JavaScriptå¼•æ“(æ¨èQuickJS)
2. åˆ†æNetSurfçš„JavaScriptæ¥å£
3. å®ç°å¼•æ“é€‚é…å±‚ï¼Œæ›¿æ¢åŸæœ‰JavaScriptå¼•æ“
4. æµ‹è¯•å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆçš„JavaScriptåŠŸèƒ½
5. è°ƒä¼˜å’Œä¿®å¤å…¼å®¹æ€§é—®é¢˜

#### æ¨èæ–¹æ¡ˆ
è€ƒè™‘åˆ°reMarkableè®¾å¤‡çš„èµ„æºé™åˆ¶å’Œå®ç°å¤æ‚åº¦ï¼Œ**æ¨èæ–¹æ¡ˆD(æ›¿æ¢JavaScriptå¼•æ“)**ï¼Œå…·ä½“é€‰æ‹©QuickJSä½œä¸ºæ›¿ä»£å¼•æ“ï¼ŒåŸå› å¦‚ä¸‹:
1. èµ„æºå ç”¨ä½ï¼Œé€‚åˆåµŒå…¥å¼è®¾å¤‡
2. JavaScriptæ”¯æŒè¾ƒå®Œæ•´ï¼Œèƒ½å¤Ÿå¤„ç†å¾®ä¿¡è¯»ä¹¦çš„ç™»å½•å’Œå†…å®¹æ˜¾ç¤º
3. å®ç°å¤æ‚åº¦ç›¸å¯¹è¾ƒä½ï¼Œä¸éœ€è¦é‡å†™æ•´ä¸ªæ¸²æŸ“ç³»ç»Ÿ
4. å¯ä»¥ä¿æŒNetSurfçš„å…¶ä»–ä¼˜åŠ¿(è½»é‡çº§ã€å¿«é€Ÿå¯åŠ¨ç­‰)

#### å®æ–½å»ºè®®
1. å…ˆè¿›è¡ŒQuickJSä¸NetSurfçš„é›†æˆæµ‹è¯•
2. é€æ­¥æµ‹è¯•å¾®ä¿¡è¯»ä¹¦çš„å„é¡¹åŠŸèƒ½
3. é’ˆå¯¹å‘ç°çš„é—®é¢˜è¿›è¡Œä¼˜åŒ–å’Œä¿®å¤
4. å¦‚æœä»æœ‰åŠŸèƒ½ç¼ºå¤±ï¼Œå¯è€ƒè™‘ç»“åˆæ–¹æ¡ˆBå®ç°å…³é”®åŠŸèƒ½

### A.6 å·²éªŒè¯å¤±è´¥çš„ç»éªŒä¸æœªéªŒè¯æ–¹æ¡ˆ

#### å·²éªŒè¯å¤±è´¥çš„ç»éªŒ

1. **çº¯NetSurfæ–¹æ¡ˆ**
   - **å°è¯•**: ç›´æ¥ä½¿ç”¨NetSurfè®¿é—®å¾®ä¿¡è¯»ä¹¦
   - **å¤±è´¥åŸå› **: NetSurfä½¿ç”¨Duktape JavaScriptå¼•æ“ï¼Œæ— æ³•å¤„ç†ç°ä»£ç½‘ç«™çš„å¤æ‚JavaScript
   - **ç»éªŒæ•™è®­**: éœ€è¦å¢å¼ºJavaScriptå¼•æ“æ”¯æŒæˆ–é‡‡ç”¨æ··åˆæ–¹æ¡ˆ

2. **lightpanda CDPæ–¹æ¡ˆ**
   - **å°è¯•**: ä½¿ç”¨lightpandaçš„Chrome DevTools Protocolæ¥å£
   - **å¤±è´¥åŸå› **: lightpandaçš„CDPå®ç°ä¸å®Œæ•´ï¼Œç¼ºå°‘inspecté“¾æ¥
   - **ç»éªŒæ•™è®­**: è½»é‡çº§å¼•æ“çš„åè®®æ”¯æŒå¯èƒ½ä¸å®Œæ•´

3. **æœ¬åœ°Node.jsä»£ç†æ–¹æ¡ˆ**
   - **å°è¯•**: åœ¨Macä¸Šè¿è¡ŒNode.jsä»£ç†æœåŠ¡å™¨ï¼Œé€šè¿‡SSHè°ƒç”¨reMarkableä¸Šçš„lightpanda
   - **å¤±è´¥åŸå› **: ç”¨æˆ·æ˜ç¡®è¦æ±‚"åœ¨è®¾å¤‡ä¸Šç›´æ¥è¿è¡Œçš„appï¼Œä¸éœ€è¦åœ¨macä¸Šè®¿é—®çš„æ–¹æ¡ˆ"
   - **ç»éªŒæ•™è®­**: å¿…é¡»æ»¡è¶³æœ¬åœ°è¿è¡Œè¦æ±‚

4. **Node.jsåœ¨reMarkableä¸Šè¿è¡Œ**
   - **å°è¯•**: åœ¨reMarkableä¸Šå®‰è£…å’Œè¿è¡ŒNode.js
   - **å¤±è´¥åŸå› **: reMarkableä¸Šæ²¡æœ‰Node.jsç¯å¢ƒ
   - **ç»éªŒæ•™è®­**: éœ€è€ƒè™‘è®¾å¤‡ç¯å¢ƒé™åˆ¶

5. **netcat (nc)ç®€å•HTTPæœåŠ¡å™¨**
   - **å°è¯•**: ä½¿ç”¨BusyBoxçš„ncå‘½ä»¤åˆ›å»ºç®€å•HTTPæœåŠ¡å™¨
   - **å¤±è´¥åŸå› **: BusyBoxçš„ncåŠŸèƒ½å¤ªåŸºç¡€ï¼Œä¸æ”¯æŒlistenæ¨¡å¼
   - **ç»éªŒæ•™è®­**: åŸºç¡€å·¥å…·å¯èƒ½åŠŸèƒ½å—é™

6. **å½“å‰æ··åˆæ–¹æ¡ˆï¼ˆlightpanda + C HTTPæœåŠ¡å™¨ + NetSurfï¼‰**
   - **å°è¯•**: ä½¿ç”¨lightpandaè·å–å†…å®¹ï¼ŒCè¯­è¨€HTTPæœåŠ¡å™¨ä»£ç†ï¼ŒNetSurfæ˜¾ç¤º
   - **å½“å‰çŠ¶æ€**: HTTPæœåŠ¡å™¨å·¥ä½œæ­£å¸¸ï¼Œä½†è§¦æ‘¸è¾“å…¥æ— ååº”
   - **å¤±è´¥åŸå› **: NetSurfçš„è¾“å…¥è®¾å¤‡è¯†åˆ«æœ‰é—®é¢˜ï¼Œevent2ï¼ˆç¬”ï¼‰å’Œevent3ï¼ˆè§¦æ‘¸ï¼‰éƒ½è¢«è¯†åˆ«ä¸ºmultitouchï¼Œå¯¼è‡´è§¦æ‘¸è®¾å¤‡è¢«è·³è¿‡
   - **ç»éªŒæ•™è®­**: è¾“å…¥è®¾å¤‡è¯†åˆ«æ˜¯å…³é”®é—®é¢˜ï¼Œéœ€è¦æ·±å…¥ä¿®æ”¹æºç 

#### æœªéªŒè¯ä½†å»ºè®®çš„æ–¹æ¡ˆ

1. **ä¿®å¤NetSurfè¾“å…¥è®¾å¤‡è¯†åˆ«**
   - **æ–¹æ¡ˆ**: ä¿®æ”¹NetSurfæºç ï¼Œæ”¹è¿›è®¾å¤‡è¯†åˆ«é€»è¾‘ï¼Œé¿å…ç¬”è®¾å¤‡è¢«è¯¯è¯†åˆ«ä¸ºè§¦æ‘¸è®¾å¤‡
   - **çŠ¶æ€**: å·²ä¿®æ”¹ä»£ç ï¼Œä½†ç¼–è¯‘æ—¶å‡ºç°libevdevé“¾æ¥é”™è¯¯
   - **ä¸‹ä¸€æ­¥**: ä¿®å¤ç¼–è¯‘é—®é¢˜ï¼Œé‡æ–°ç¼–è¯‘NetSurf
   - **è¯„ä¼°**: ä¸­ç­‰éš¾åº¦ï¼Œå¯èƒ½è§£å†³å½“å‰æ··åˆæ–¹æ¡ˆçš„è¾“å…¥é—®é¢˜

2. **ä½¿ç”¨å…¶ä»–è½»é‡çº§æµè§ˆå™¨å¼•æ“**
   - **æ–¹æ¡ˆ**: è€ƒè™‘ä½¿ç”¨å…¶ä»–æ”¯æŒç°ä»£JavaScriptçš„è½»é‡çº§æµè§ˆå™¨
   - **çŠ¶æ€**: æœªå°è¯•
   - **è¯„ä¼°**: éœ€è¦è°ƒç ”é€‚åˆçš„æ›¿ä»£æ–¹æ¡ˆï¼Œå¦‚Falkonã€Qutebrowserç­‰

3. **ç›´æ¥ä½¿ç”¨lightpandaçš„GUIæ¨¡å¼**
   - **æ–¹æ¡ˆ**: æ¢ç´¢lightpandaæ˜¯å¦æœ‰åŸç”ŸGUIæ¨¡å¼
   - **çŠ¶æ€**: æœªæ·±å…¥æ¢ç´¢
   - **è¯„ä¼°**: å¦‚æœlightpandaæ”¯æŒGUIæ¨¡å¼ï¼Œå¯èƒ½ç®€åŒ–æ•´ä½“æ¶æ„

4. **ä½¿ç”¨Qt WebEngine**
   - **æ–¹æ¡ˆ**: åœ¨reMarkableä¸Šè¿è¡ŒQt WebEngine
   - **çŠ¶æ€**: æ—©æœŸè¢«åˆ¤å®šä¸ºä¸å¯è¡Œï¼Œä½†æœªè¯¦ç»†éªŒè¯
   - **è¯„ä¼°**: éœ€è¦é‡æ–°è¯„ä¼°èµ„æºå ç”¨å’Œå¯è¡Œæ€§

#### ç»éªŒæ€»ç»“ä¸å»ºè®®

1. **é¿å…çš„é™·é˜±**:
   - ä¸è¦å°è¯•åœ¨reMarkableä¸Šè¿è¡Œå®Œæ•´çš„ç°ä»£æµè§ˆå™¨å¼•æ“
   - ä¸è¦ä¾èµ–Macæˆ–å…¶ä»–å¤–éƒ¨è®¾å¤‡çš„ä»£ç†æ–¹æ¡ˆ
   - ä¸è¦å‡è®¾åŸºç¡€å·¥å…·(ncç­‰)å…·æœ‰å®Œæ•´åŠŸèƒ½

2. **æœ‰å‰æ™¯çš„æ–¹å‘**:
   - ä¿®å¤NetSurfè¾“å…¥è®¾å¤‡è¯†åˆ«é—®é¢˜
   - æ›¿æ¢NetSurfçš„JavaScriptå¼•æ“ä¸ºQuickJSæˆ–Duktape
   - æ¢ç´¢lightpandaçš„å®Œæ•´åŠŸèƒ½å’Œé™åˆ¶
   - è€ƒè™‘æ··åˆæ¸²æŸ“æ–¹æ¡ˆï¼Œå…³é”®åŠŸèƒ½ä½¿ç”¨APIç›´æ¥è°ƒç”¨

3. **å®æ–½å»ºè®®**:
   - ä¼˜å…ˆè§£å†³å½“å‰æ··åˆæ–¹æ¡ˆçš„è¾“å…¥é—®é¢˜
   - å¹¶è¡Œè°ƒç ”QuickJSä¸NetSurfé›†æˆçš„å¯è¡Œæ€§
   - è¯¦ç»†è¯„ä¼°Qt WebEngineçš„èµ„æºéœ€æ±‚
   - å‡†å¤‡å¤‡é€‰æ–¹æ¡ˆï¼Œé¿å…å•ä¸€æŠ€æœ¯è·¯çº¿ä¾èµ–
  
### A.5 å¾®ä¿¡è¯»ä¹¦ä½¿ç”¨æŠ€å·§

  1. **ç™»å½•æ–¹å¼**:
   - æ‰«ç ç™»å½•: åœ¨ç½‘é¡µä¸Šæ‰¾åˆ°æ‰«ç ç™»å½•ï¼Œç”¨æ‰‹æœºå¾®ä¿¡æ‰«ç 
   - è´¦å·å¯†ç ç™»å½•: ç‚¹å‡»å³ä¸‹è§’é”®ç›˜å›¾æ ‡ï¼Œè¾“å…¥è´¦å·å¯†ç 

2. **é˜…è¯»æ“ä½œ**:
   - ç¿»é¡µ: ç”¨ç¬”æˆ–æ‰‹æŒ‡æ»‘åŠ¨
   - è¿”å›ä¹¦æ¶: ç‚¹å‡»æµè§ˆå™¨è¿”å›æŒ‰é’®
   - è°ƒæ•´å­—ä½“: åœ¨å¾®ä¿¡è¯»ä¹¦ç½‘é¡µå†…è°ƒæ•´

3. **è™šæ‹Ÿé”®ç›˜ä½¿ç”¨**:
   - ç‚¹å‡»å³ä¸‹è§’é”®ç›˜å›¾æ ‡ ğŸ¹
   - é”®ç›˜ä»åº•éƒ¨å¼¹å‡º
   - è¾“å…¥å®Œæˆåç‚¹å‡»å…³é—­

4. **æ€§èƒ½ä¼˜åŒ–æŠ€å·§**:
   - ä½¿ç”¨é€‚åˆçš„ç¼©æ”¾æ¯”ä¾‹(100-110)
   - ç¦ç”¨ä¸å¿…è¦çš„JavaScriptåŠŸèƒ½
   - å®šæœŸæ¸…ç†ç¼“å­˜ï¼Œé‡Šæ”¾å­˜å‚¨ç©ºé—´

## é™„å½•B: æŠ€æœ¯å®ç°ç»†èŠ‚

### B.1 NetSurfä¸QuickJSé›†æˆæ–¹æ¡ˆ

#### æŠ€æœ¯èƒŒæ™¯
NetSurfé»˜è®¤ä½¿ç”¨Duktapeä½œä¸ºJavaScriptå¼•æ“ï¼Œä½†å…¶å¯¹ç°ä»£JavaScriptæ”¯æŒæœ‰é™ã€‚QuickJSæ˜¯ä¸€ä¸ªæ›´ç°ä»£ã€æ›´è½»é‡çº§çš„JavaScriptå¼•æ“ï¼Œæ”¯æŒES2020æ ‡å‡†ï¼Œæ›´é€‚åˆå¤„ç†å¾®ä¿¡è¯»ä¹¦ç­‰ç°ä»£Webåº”ç”¨ã€‚

#### é›†æˆæ­¥éª¤

1. **å‡†å¤‡äº¤å‰ç¼–è¯‘ç¯å¢ƒ**
   ```bash
   # å®‰è£…äº¤å‰ç¼–è¯‘å·¥å…·é“¾
   sudo apt-get install gcc-arm-linux-gnueabihf
   ```

2. **ç¼–è¯‘QuickJS for reMarkable**
   ```bash
   git clone https://github.com/bellard/quickjs.git
   cd quickjs
   make CONFIG_arm64=y
   # é’ˆå¯¹reMarkableçš„ARMæ¶æ„è¿›è¡Œä¼˜åŒ–
   ```

3. **ä¿®æ”¹NetSurfæºç **
   - æ‰¾åˆ°JavaScriptå¼•æ“æ¥å£æ–‡ä»¶(é€šå¸¸åœ¨`content/handlers/javascript/`)
   - æ›¿æ¢Duktapeç›¸å…³ä»£ç ä¸ºQuickJSæ¥å£
   - ç¡®ä¿APIå…¼å®¹æ€§

4. **é‡æ–°ç¼–è¯‘NetSurf**
   ```bash
   make TARGET=arm-linux-gnueabihf
   ```

#### é¢„æœŸæ•ˆæœ
- æ”¯æŒæ›´å®Œæ•´çš„JavaScriptç‰¹æ€§
- æ›´å¥½çš„å¾®ä¿¡è¯»ä¹¦å…¼å®¹æ€§
- ä¿æŒè½»é‡çº§ç‰¹æ€§

### B.2 å¾®ä¿¡è¯»ä¹¦APIåˆ†æ

#### å®˜æ–¹APIç°çŠ¶
å¾®ä¿¡è¯»ä¹¦ç›®å‰**æœªæä¾›å…¬å¼€çš„å®˜æ–¹API**ï¼Œè¿™æ„å‘³ç€ä»»ä½•APIè°ƒç”¨éƒ½æ˜¯åŸºäºå¯¹ç°æœ‰Webæ¥å£çš„é€†å‘å·¥ç¨‹åˆ†æã€‚è¿™ç§åšæ³•å­˜åœ¨ä¸€å®šçš„æŠ€æœ¯å’Œæ³•å¾‹é£é™©ï¼Œä½†å·²æœ‰å¤šä¸ªå¼€æºé¡¹ç›®è¯æ˜äº†å…¶å¯è¡Œæ€§ã€‚

#### éå®˜æ–¹APIä½¿ç”¨å¯è¡Œæ€§åˆ†æ

##### æŠ€æœ¯å¯è¡Œæ€§
åŸºäºå·²æœ‰çš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨éå®˜æ–¹APIå¼€å‘å¾®ä¿¡è¯»ä¹¦åº”ç”¨åœ¨æŠ€æœ¯ä¸Šæ˜¯å¯è¡Œçš„ï¼š

1. **å·²æœ‰æˆåŠŸæ¡ˆä¾‹** <mcreference link="https://blog.csdn.net/mighty13/article/details/119257353" index="1">1</mcreference>:
   - **wereaderé¡¹ç›®** (https://github.com/arry-lee/wereader): æœ€æ—©è§£é‡Šå¾®ä¿¡è¯»ä¹¦APIçš„é¡¹ç›®
   - **å¾®ä¿¡è¯»ä¹¦åŠ©æ‰‹é¡¹ç›®** (https://github.com/Higurashi-kagome/pythontools/tree/master/wereader): æ”¹è¿›ç‰ˆæœ¬ï¼Œæä¾›æ›´å¤šAPIå’ŒGUIç™»å½•
   - **çˆ¬è™«æ¡ˆä¾‹é¡¹ç›®** (https://github.com/shengqiangzhang/examples-of-web-crawlers): åŸºäºPyQTçš„GUIå®ç°

2. **APIè·å–æ–¹å¼**:
   - é€šè¿‡æµè§ˆå™¨å¼€å‘è€…å·¥å…·è·å–Cookie
   - åˆ†æå¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆçš„ç½‘ç»œè¯·æ±‚
   - æ¨¡æ‹Ÿæµè§ˆå™¨è¯·æ±‚å¤´å’Œå‚æ•°

3. **å·²çŸ¥çš„APIç«¯ç‚¹**:
   - ç”¨æˆ·è®¤è¯: `https://i.weread.qq.com/user/notebooks`
   - ä¹¦æ¶åŒæ­¥: `https://i.weread.qq.com/shelf/sync?userVid={userVid}`
   - ä¹¦ç±å†…å®¹: `https://i.weread.qq.com/book/info?bookId={bookId}`
   - ç¬”è®°å’Œæ ‡æ³¨: å¤šä¸ªç›¸å…³ç«¯ç‚¹

##### æ³•å¾‹ä¸æœåŠ¡æ¡æ¬¾é£é™©

1. **æ³•å¾‹é£é™©** <mcreference link="https://blog.csdn.net/FB13713612741/article/details/145991250" index="4">4</mcreference>:
   - é€†å‘å·¥ç¨‹å¯èƒ½è¿åæŸäº›åœ°åŒºçš„æ³•å¾‹æ³•è§„
   - å¯èƒ½è¢«è§†ä¸ºä¾µçŠ¯çŸ¥è¯†äº§æƒçš„è¡Œä¸º
   - éœ€éµå®ˆã€Šå¾®ä¿¡è½¯ä»¶è®¸å¯åŠæœåŠ¡åè®®ã€‹ <mcreference link="https://wenku.csdn.net/answer/6221dy7do7" index="1">1</mcreference>

2. **æœåŠ¡æ¡æ¬¾é£é™©**:
   - å¾®ä¿¡è¯»ä¹¦æœåŠ¡æ¡æ¬¾å¯èƒ½ç¦æ­¢éå®˜æ–¹APIè®¿é—®
   - å¯èƒ½å¯¼è‡´è´¦å·è¢«å°ç¦æˆ–åŠŸèƒ½é™åˆ¶
   - é¢‘ç¹è¯·æ±‚å¯èƒ½è§¦å‘åçˆ¬è™«æœºåˆ¶

3. **æ•°æ®éšç§é£é™©**:
   - éœ€å¤„ç†ç”¨æˆ·è®¤è¯ä¿¡æ¯(Cookie)
   - å¯èƒ½æ¶‰åŠä¸ªäººé˜…è¯»æ•°æ®çš„è·å–å’Œå­˜å‚¨
   - éœ€éµå®ˆæ•°æ®ä¿æŠ¤æ³•è§„

##### å®é™…åº”ç”¨é™åˆ¶

1. **åŠŸèƒ½é™åˆ¶**:
   - åªèƒ½è·å–å¯¹æœ‹å‹å¼€æ”¾çš„å›¾ä¹¦ä¿¡æ¯ï¼Œæ— æ³•è·å–ç§å¯†å›¾ä¹¦ <mcreference link="https://blog.csdn.net/mighty13/article/details/119257353" index="1">1</mcreference>
   - éƒ¨åˆ†é«˜çº§åŠŸèƒ½å¯èƒ½æ— æ³•å®ç°
   - APIå¯èƒ½éšæ—¶å˜æ›´ï¼Œå¯¼è‡´åŠŸèƒ½å¤±æ•ˆ

2. **ç»´æŠ¤æˆæœ¬**:
   - éœ€è¦æŒç»­è·Ÿè¸ªAPIå˜æ›´
   - å¯èƒ½éœ€è¦é¢‘ç¹æ›´æ–°ä»£ç 
   - ç¼ºä¹å®˜æ–¹æ”¯æŒå’Œæ–‡æ¡£

#### æ¨èå®ç°ç­–ç•¥

è€ƒè™‘åˆ°ä¸Šè¿°é£é™©å’Œé™åˆ¶ï¼Œå¯¹äºreMarkableä¸Šçš„å¾®ä¿¡è¯»ä¹¦åº”ç”¨ï¼Œå»ºè®®é‡‡ç”¨ä»¥ä¸‹ç­–ç•¥ï¼š

1. **æ··åˆæ–¹æ¡ˆ**:
   - åŸºç¡€åŠŸèƒ½ä½¿ç”¨NetSurfæµè§ˆå™¨æ¸²æŸ“
   - å…³é”®åŠŸèƒ½(å¦‚ç¬”è®°åŒæ­¥)ä½¿ç”¨APIå®ç°
   - é™ä½å¯¹å•ä¸€æ–¹æ¡ˆçš„ä¾èµ–

2. **ç”¨æˆ·è‡ªä¸»è®¤è¯**:
   - ä¸å­˜å‚¨ç”¨æˆ·è®¤è¯ä¿¡æ¯
   - è®©ç”¨æˆ·è‡ªè¡Œè·å–å’Œè¾“å…¥Cookie
   - æä¾›æ¸…æ™°çš„è·å–æŒ‡å—

3. **åŠŸèƒ½è¾¹ç•Œæ˜ç¡®**:
   - åªå®ç°åŸºç¡€é˜…è¯»å’Œç¬”è®°åŠŸèƒ½
   - ä¸å°è¯•è·å–ä»˜è´¹æˆ–ç§å¯†å†…å®¹
   - å°Šé‡å¹³å°è§„åˆ™å’Œç‰ˆæƒ

4. **è½»é‡çº§å®ç°**:
   - æœ€å°åŒ–APIè°ƒç”¨é¢‘ç‡
   - å®ç°æœ¬åœ°ç¼“å­˜å‡å°‘è¯·æ±‚
   - é¿å…å¤§è§„æ¨¡æ•°æ®è·å–

#### APIè°ƒç”¨ç¤ºä¾‹

```c
// ç®€å•çš„HTTPè¯·æ±‚ç¤ºä¾‹
#include <stdio.h>
#include <curl/curl.h>

void fetch_bookshelf(const char* cookie) {
    CURL *curl;
    CURLcode res;
    
    curl = curl_easy_init();
    if(curl) {
        char url[256];
        snprintf(url, sizeof(url), "https://i.weread.qq.com/shelf/sync");
        
        struct curl_slist *headers = NULL;
        char cookie_header[512];
        snprintf(cookie_header, sizeof(cookie_header), "Cookie: %s", cookie);
        headers = curl_slist_append(headers, cookie_header);
        
        curl_easy_setopt(curl, CURLOPT_URL, url);
        curl_easy_setopt(curl, CURLOPT_HTTPHEADER, headers);
        
        res = curl_easy_perform(curl);
        if(res != CURLE_OK)
            fprintf(stderr, "curl_easy_perform() failed: %s\n",
                    curl_easy_strerror(res));
        
        curl_easy_cleanup(curl);
        curl_slist_free_all(headers);
    }
}
```

#### é’ˆå¯¹é˜…è¯»æ”¶è´¹ç« èŠ‚çš„å®ç°æ–¹æ¡ˆ

æ ¹æ®æ‚¨çš„éœ€æ±‚ï¼Œæˆ‘ä»¬ä¸“æ³¨äºå®ç°å¾®ä¿¡è¯»ä¹¦çš„é˜…è¯»åŠŸèƒ½ï¼Œç‰¹åˆ«æ˜¯èƒ½å¤Ÿé˜…è¯»ç”¨æˆ·è´¦æˆ·é‡Œçš„æ”¶è´¹ç« èŠ‚ã€‚ä»¥ä¸‹æ˜¯é’ˆå¯¹è¿™ä¸€å…·ä½“ç›®æ ‡çš„å®ç°æ–¹æ¡ˆï¼š

##### æ”¶è´¹ç« èŠ‚è®¿é—®æœºåˆ¶åˆ†æ

1. **å¾®ä¿¡è¯»ä¹¦æ”¶è´¹æ–¹å¼** <mcreference link="http://wap.zol.com.cn/ask/x_15504477.html" index="4">4</mcreference>:
   - æŒ‰æœ¬æ”¶è´¹ï¼šè´­ä¹°æ•´æœ¬ä¹¦
   - æŒ‰ç« æ”¶è´¹ï¼šåªè´­ä¹°æ„Ÿå…´è¶£çš„ç« èŠ‚
   - ä¼šå‘˜æ— é™å¡ï¼šä»˜è´¹ä¼šå‘˜å¯å…è´¹é˜…è¯»éƒ¨åˆ†æˆ–å…¨éƒ¨å†…å®¹

2. **æ”¶è´¹ç« èŠ‚è®¿é—®åŸç†**:
   - æ”¶è´¹ç« èŠ‚é€šè¿‡ç”¨æˆ·è®¤è¯çŠ¶æ€å’Œè´­ä¹°è®°å½•éªŒè¯è®¿é—®æƒé™
   - å·²è´­ä¹°ç« èŠ‚ä¼šåœ¨ç”¨æˆ·è´¦æˆ·ä¸­è®°å½•è´­ä¹°ä¿¡æ¯
   - ä¼šå‘˜çŠ¶æ€éªŒè¯å†³å®šæ˜¯å¦å¯è®¿é—®ç‰¹å®šå†…å®¹

##### æ¨èå®ç°æ–¹æ¡ˆ

åŸºäºå¯¹å¾®ä¿¡è¯»ä¹¦æ”¶è´¹ç« èŠ‚è®¿é—®æœºåˆ¶çš„åˆ†æï¼Œæ¨èä»¥ä¸‹å®ç°æ–¹æ¡ˆï¼š

###### æ–¹æ¡ˆä¸€ï¼šæµè§ˆå™¨æ¸²æŸ“ + ç”¨æˆ·è®¤è¯ï¼ˆæ¨èï¼‰

è¿™æ˜¯æœ€ç›´æ¥ä¸”å¯è¡Œçš„æ–¹æ¡ˆï¼Œé€šè¿‡å®Œæ•´çš„æµè§ˆå™¨ç¯å¢ƒç¡®ä¿ç”¨æˆ·è®¤è¯çŠ¶æ€å’Œè´­ä¹°è®°å½•æ­£å¸¸å·¥ä½œï¼š

1. **æŠ€æœ¯å®ç°**:
   - ä½¿ç”¨NetSurfæˆ–æ”¹è¿›åçš„æµè§ˆå™¨å¼•æ“æ¸²æŸ“å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆ
   - ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿæ­£å¸¸ç™»å½•å¾®ä¿¡è¯»ä¹¦è´¦æˆ·
   - ä¿æŒå®Œæ•´çš„ä¼šè¯çŠ¶æ€å’ŒCookieä¿¡æ¯

2. **æ”¶è´¹ç« èŠ‚è®¿é—®**:
   - ç”¨æˆ·é€šè¿‡æ­£å¸¸ç™»å½•æµç¨‹è®¿é—®å·²è´­ä¹°å†…å®¹
   - æµè§ˆå™¨è‡ªåŠ¨å¤„ç†è®¤è¯çŠ¶æ€å’Œè´­ä¹°è®°å½•éªŒè¯
   - æ— éœ€é¢å¤–APIè°ƒç”¨æˆ–ç‰¹æ®Šå¤„ç†

3. **ä¼˜åŠ¿**:
   - å®Œå…¨ç¬¦åˆå¾®ä¿¡è¯»ä¹¦çš„ä½¿ç”¨æ¡æ¬¾
   - èƒ½å¤Ÿè®¿é—®ç”¨æˆ·è´¦æˆ·ä¸­æ‰€æœ‰å·²è´­ä¹°å†…å®¹
   - æŠ€æœ¯å®ç°ç›¸å¯¹ç®€å•ç›´æ¥

4. **æŒ‘æˆ˜**:
   - éœ€è¦è§£å†³NetSurfçš„JavaScriptæ”¯æŒé—®é¢˜ï¼ˆå‚è€ƒA.4è§£å†³æ–¹æ¡ˆï¼‰
   - éœ€è¦ç¡®ä¿è¾“å…¥è®¾å¤‡æ­£å¸¸å·¥ä½œä»¥æ”¯æŒç™»å½•æ“ä½œ

###### æ–¹æ¡ˆäºŒï¼šAPIè°ƒç”¨ + ä¼šè¯ä¿æŒ

æ­¤æ–¹æ¡ˆé€šè¿‡APIç›´æ¥è·å–å†…å®¹ï¼Œä½†éœ€è¦ä¿æŒæœ‰æ•ˆçš„ç”¨æˆ·ä¼šè¯ï¼š

1. **æŠ€æœ¯å®ç°**:
   - è·å–ç”¨æˆ·ç™»å½•åçš„æœ‰æ•ˆCookie
   - é€šè¿‡APIè°ƒç”¨è·å–ä¹¦ç±å†…å®¹å’Œç« èŠ‚ä¿¡æ¯
   - æœ¬åœ°æ¸²æŸ“è·å–åˆ°çš„å†…å®¹

2. **æ”¶è´¹ç« èŠ‚è®¿é—®**:
   - ä½¿ç”¨æœ‰æ•ˆçš„ç”¨æˆ·ä¼šè¯è°ƒç”¨API
   - APIä¼šæ ¹æ®ç”¨æˆ·è´­ä¹°è®°å½•è¿”å›ç›¸åº”å†…å®¹
   - éœ€è¦å¤„ç†å¯èƒ½çš„DRMä¿æŠ¤å†…å®¹

3. **ä¼˜åŠ¿**:
   - å¯ä»¥å®ç°æ›´å®šåˆ¶åŒ–çš„é˜…è¯»ä½“éªŒ
   - å‡å°‘å¯¹å®Œæ•´æµè§ˆå™¨ç¯å¢ƒçš„ä¾èµ–

4. **æŒ‘æˆ˜**:
   - éœ€è¦é€†å‘åˆ†æAPIæ¥å£
   - å¯èƒ½è¿åæœåŠ¡æ¡æ¬¾
   - éœ€è¦å¤„ç†DRMä¿æŠ¤å’Œå†…å®¹åŠ å¯†

##### å…·ä½“å®æ–½æ­¥éª¤

é’ˆå¯¹æ¨èçš„æ–¹æ¡ˆä¸€ï¼Œä»¥ä¸‹æ˜¯å…·ä½“å®æ–½æ­¥éª¤ï¼š

1. **æ”¹è¿›NetSurfæµè§ˆå™¨å¼•æ“**:
   - å®æ–½A.4èŠ‚ä¸­çš„JavaScriptå¼•æ“æ›¿æ¢æ–¹æ¡ˆ
   - ä¿®å¤è¾“å…¥è®¾å¤‡è¯†åˆ«é—®é¢˜
   - ç¡®ä¿èƒ½å¤Ÿæ­£å¸¸å¤„ç†ç™»å½•æµç¨‹

2. **ä¼˜åŒ–é˜…è¯»ä½“éªŒ**:
   - å®ç°é€‚åˆreMarkableå±å¹•çš„æ¸²æŸ“ä¼˜åŒ–
   - æ·»åŠ é€‚åˆE-Inkæ˜¾ç¤ºçš„æ ·å¼è°ƒæ•´
   - å®ç°æµç•…çš„é¡µé¢ç¿»é¡µåŠŸèƒ½

3. **ç”¨æˆ·è®¤è¯æµç¨‹**:
   - ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡æµè§ˆå™¨ç•Œé¢å®Œæˆç™»å½•
   - ä¿æŒç™»å½•çŠ¶æ€å’Œä¼šè¯ä¿¡æ¯
   - æ”¯æŒäºŒç»´ç æ‰«æç™»å½•ï¼ˆå¦‚éœ€è¦ï¼‰

4. **æ€§èƒ½ä¼˜åŒ–**:
   - å®ç°å†…å®¹ç¼“å­˜æœºåˆ¶
   - ä¼˜åŒ–ç½‘ç»œè¯·æ±‚å‡å°‘æ•°æ®ä½¿ç”¨
   - å®ç°é¢„åŠ è½½åŠŸèƒ½æå‡é˜…è¯»ä½“éªŒ

##### æ³¨æ„äº‹é¡¹

1. **ç‰ˆæƒå’Œåˆè§„**:
   - åªè®¿é—®ç”¨æˆ·å·²è´­ä¹°çš„å†…å®¹
   - ä¸å°è¯•ç»•è¿‡DRMä¿æŠ¤æˆ–ä»˜è´¹æœºåˆ¶
   - å°Šé‡å†…å®¹ç‰ˆæƒå’Œå¹³å°è§„åˆ™

2. **ç”¨æˆ·ä½“éªŒ**:
   - ç¡®ä¿ç™»å½•æµç¨‹ç®€å•ç›´è§‚
   - ä¿æŒä¸å¾®ä¿¡è¯»ä¹¦åŸç”Ÿåº”ç”¨ç›¸è¿‘çš„é˜…è¯»ä½“éªŒ
   - ä¼˜åŒ–E-Inkæ˜¾ç¤ºæ•ˆæœ

3. **æŠ€æœ¯é™åˆ¶**:
   - reMarkableè®¾å¤‡æ€§èƒ½é™åˆ¶å¯èƒ½å½±å“å¤æ‚ç½‘é¡µæ¸²æŸ“
   - éœ€è¦å¹³è¡¡åŠŸèƒ½å®Œæ•´æ€§å’Œæ€§èƒ½è¡¨ç°
   - è€ƒè™‘ç¦»çº¿é˜…è¯»éœ€æ±‚

##### ç»“è®º

é’ˆå¯¹é˜…è¯»æ”¶è´¹ç« èŠ‚çš„éœ€æ±‚ï¼Œ**æµè§ˆå™¨æ¸²æŸ“ + ç”¨æˆ·è®¤è¯æ–¹æ¡ˆ**æ˜¯æœ€ç›´æ¥ã€æœ€åˆè§„ä¸”æœ€å¯è¡Œçš„å®ç°æ–¹å¼ã€‚é€šè¿‡æ”¹è¿›NetSurfæµè§ˆå™¨å¼•æ“çš„JavaScriptæ”¯æŒå’Œè¾“å…¥å¤„ç†ï¼Œç”¨æˆ·å¯ä»¥åœ¨reMarkableè®¾å¤‡ä¸Šæ­£å¸¸ç™»å½•å¾®ä¿¡è¯»ä¹¦ï¼Œè®¿é—®å…¶è´¦æˆ·ä¸­æ‰€æœ‰å·²è´­ä¹°çš„å†…å®¹ï¼ŒåŒ…æ‹¬æ”¶è´¹ç« èŠ‚ã€‚

è¿™ç§æ–¹æ¡ˆé¿å…äº†APIé€†å‘å·¥ç¨‹å¯èƒ½å¸¦æ¥çš„æ³•å¾‹å’ŒæŠ€æœ¯é£é™©ï¼ŒåŒæ—¶ç¡®ä¿ç”¨æˆ·èƒ½å¤Ÿè®¿é—®å…¶åˆæ³•è´­ä¹°çš„ä»˜è´¹å†…å®¹ï¼Œæ˜¯æœ€å¹³è¡¡å’Œå¯æŒç»­çš„è§£å†³æ–¹æ¡ˆã€‚

### B.3 è¾“å…¥è®¾å¤‡ä¿®å¤æ–¹æ¡ˆ

#### é—®é¢˜åˆ†æ
NetSurfåœ¨reMarkableä¸Šçš„è¾“å…¥è®¾å¤‡è¯†åˆ«é—®é¢˜ï¼š
- event2(ç¬”)å’Œevent3(è§¦æ‘¸)éƒ½è¢«è¯†åˆ«ä¸ºmultitouch
- å¯¼è‡´è§¦æ‘¸è®¾å¤‡è¢«è·³è¿‡ï¼Œæ— æ³•å“åº”è§¦æ‘¸è¾“å…¥

#### è§£å†³æ–¹æ¡ˆ

1. **ä¿®æ”¹NetSurfè¾“å…¥è®¾å¤‡è¯†åˆ«é€»è¾‘**
   ```c
   // åœ¨frontend/framebuffer/input.cä¸­ä¿®æ”¹è®¾å¤‡è¯†åˆ«é€»è¾‘
   static bool is_touch_device(int fd) {
       // æ·»åŠ æ›´ç²¾ç¡®çš„è®¾å¤‡ç±»å‹æ£€æµ‹
       // åŒºåˆ†ç¬”è®¾å¤‡å’Œè§¦æ‘¸è®¾å¤‡
   }
   ```

2. **é‡æ–°ç¼–è¯‘NetSurf**
   ```bash
   # ç¡®ä¿é“¾æ¥äº†æ­£ç¡®çš„libevdevåº“
   make NETSURF_USE_EVDEV=yes TARGET=arm-linux-gnueabihf
   ```

3. **æµ‹è¯•è¾“å…¥è®¾å¤‡**
   ```bash
   # æ£€æŸ¥è®¾å¤‡äº‹ä»¶
   cat /proc/bus/input/devices
   # æµ‹è¯•äº‹ä»¶
   evtest /dev/input/event2
   evtest /dev/input/event3
   ```

### B.4 Lightpandaæµè§ˆå™¨å¼•æ“åˆ†æ

#### Lightpandaé¡¹ç›®æ¦‚è¿°

Lightpandaæ˜¯ä¸€ä¸ªä¸“ä¸ºæ— å¤´(headless)ä½¿ç”¨è®¾è®¡çš„å¼€æºæµè§ˆå™¨å¼•æ“ï¼Œé‡‡ç”¨Zigè¯­è¨€ç¼–å†™ï¼Œå…·æœ‰è¶…ä½å†…å­˜å ç”¨å’Œæå¿«æ‰§è¡Œé€Ÿåº¦çš„ç‰¹ç‚¹ <mcreference link="https://github.com/lightpanda-io/browser" index="0">0</mcreference>ã€‚

#### æ ¸å¿ƒæŠ€æœ¯ç‰¹æ€§

1. **æ¶æ„è®¾è®¡**:
   - å®Œå…¨é‡å†™çš„æµè§ˆå™¨å¼•æ“ï¼Œä¸åŸºäºChromiumã€Blinkæˆ–WebKit
   - ä½¿ç”¨Zig 0.15.1å¼€å‘ï¼Œæ³¨é‡æ€§èƒ½å’Œå†…å­˜æ•ˆç‡
   - åŸºäºå¤šä¸ªå…³é”®ç»„ä»¶ï¼šv8 JavaScriptå¼•æ“ã€Netsurfåº“ã€Libcurlå’ŒMimalloc

2. **æ€§èƒ½ä¼˜åŠ¿** <mcreference link="http://m.toutiao.com/group/7488515747522773519/" index="2">2</mcreference>:
   - è¶…ä½å†…å­˜å ç”¨ï¼šæ¯”Chromeå°‘9å€
   - æ‰§è¡Œé€Ÿåº¦æå¿«ï¼šæ¯”Chromeå¿«11å€
   - å³æ—¶å¯åŠ¨ï¼šæ— å†·å¯åŠ¨å»¶è¿Ÿ

3. **åŠŸèƒ½æ”¯æŒ**:
   - JavaScriptæ‰§è¡Œ(v8å¼•æ“)
   - Web APIæ”¯æŒ(éƒ¨åˆ†ï¼ŒæŒç»­å¼€å‘ä¸­)
   - å…¼å®¹Playwrightã€Puppeteerã€chromedpé€šè¿‡CDP(Chrome DevTools Protocol)
   - HTTPåŠ è½½ã€HTMLè§£æã€DOMæ ‘ç”Ÿæˆ
   - XHR/Fetch APIã€Cookieç®¡ç†ã€ç½‘ç»œæ‹¦æˆª

#### å¯¹å¾®ä¿¡è¯»ä¹¦reMarkableé¡¹ç›®çš„æ½œåœ¨å¸®åŠ©

##### ä¼˜åŠ¿åˆ†æ

1. **èµ„æºæ•ˆç‡**:
   - Lightpandaçš„ä½å†…å­˜å ç”¨ç‰¹æ€§éå¸¸é€‚åˆreMarkableè®¾å¤‡çš„æœ‰é™èµ„æºç¯å¢ƒ
   - å¿«é€Ÿæ‰§è¡Œé€Ÿåº¦å¯ä»¥æå‡ç½‘é¡µåŠ è½½å’Œæ¸²æŸ“æ€§èƒ½
   - å³æ—¶å¯åŠ¨ç‰¹æ€§å¯æ”¹å–„ç”¨æˆ·ä½“éªŒ

2. **JavaScriptæ”¯æŒ**:
   - å†…ç½®å®Œæ•´çš„v8 JavaScriptå¼•æ“ï¼Œè§£å†³äº†NetSurfçš„JavaScriptæ”¯æŒä¸è¶³é—®é¢˜
   - èƒ½å¤Ÿå¤„ç†å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆçš„åŠ¨æ€å†…å®¹å’Œäº¤äº’åŠŸèƒ½
   - æ”¯æŒç°ä»£Webåº”ç”¨æ‰€éœ€çš„JavaScriptç‰¹æ€§

3. **APIå…¼å®¹æ€§**:
   - é€šè¿‡CDPå…¼å®¹Puppeteerç­‰è‡ªåŠ¨åŒ–å·¥å…·ï¼Œä¾¿äºå®ç°è‡ªåŠ¨åŒ–æ“ä½œ
   - å¯ä»¥é€šè¿‡ç¼–ç¨‹æ–¹å¼æ§åˆ¶é¡µé¢å¯¼èˆªã€å†…å®¹æå–å’Œäº¤äº’

##### æŒ‘æˆ˜ä¸é™åˆ¶

1. **å›¾å½¢æ¸²æŸ“**:
   - Lightpandaç›®å‰ä¸“æ³¨äºæ— å¤´æ¨¡å¼ï¼Œæ²¡æœ‰å›¾å½¢æ¸²æŸ“åŠŸèƒ½ <mcreference link="https://github.com/lightpanda-io/browser" index="0">0</mcreference>
   - å¯¹äºreMarkableçš„E-Inkæ˜¾ç¤ºï¼Œéœ€è¦é¢å¤–çš„æ¸²æŸ“å±‚å°†å†…å®¹è½¬æ¢ä¸ºé€‚åˆæ˜¾ç¤ºçš„æ ¼å¼

2. **å¹³å°å…¼å®¹æ€§**:
   - ç›®å‰ä¸»è¦æ”¯æŒLinux x86_64å’ŒMacOS aarch64æ¶æ„
   - reMarkableåŸºäºARMæ¶æ„ï¼Œå¯èƒ½éœ€è¦äº¤å‰ç¼–è¯‘æˆ–ç§»æ¤å·¥ä½œ
   - éœ€è¦è¯„ä¼°åœ¨Codexç³»ç»Ÿä¸Šçš„å…¼å®¹æ€§

3. **åŠŸèƒ½å®Œæ•´æ€§**:
   - é¡¹ç›®ä»å¤„äºBetaé˜¶æ®µï¼ŒWeb APIè¦†ç›–ä»åœ¨å¼€å‘ä¸­
   - å¯èƒ½å­˜åœ¨æŸäº›ç½‘ç«™å…¼å®¹æ€§é—®é¢˜
   - éœ€è¦æµ‹è¯•å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆçš„å®Œæ•´åŠŸèƒ½æ”¯æŒ

#### é›†æˆæ–¹æ¡ˆå»ºè®®

##### æ–¹æ¡ˆä¸€ï¼šLightpanda + è‡ªå®šä¹‰æ¸²æŸ“å±‚

1. **æ¶æ„è®¾è®¡**:
   ```
   å¾®ä¿¡è¯»ä¹¦ç½‘é¡µ â†’ Lightpanda(æ— å¤´æ¸²æŸ“) â†’ å†…å®¹æå– â†’ è‡ªå®šä¹‰æ¸²æŸ“å±‚ â†’ reMarkableæ˜¾ç¤º
   ```

2. **å®ç°æ­¥éª¤**:
   - ç§»æ¤Lightpandaåˆ°reMarkableå¹³å°(ARMæ¶æ„)
   - å®ç°å†…å®¹æå–å’Œè½¬æ¢æ¨¡å—
   - å¼€å‘é€‚åˆE-Inkæ˜¾ç¤ºçš„æ¸²æŸ“å¼•æ“
   - é›†æˆç”¨æˆ·è¾“å…¥å¤„ç†å’Œé¡µé¢å¯¼èˆª

3. **ä¼˜åŠ¿**:
   - å……åˆ†åˆ©ç”¨Lightpandaçš„æ€§èƒ½å’ŒJavaScriptæ”¯æŒ
   - è‡ªå®šä¹‰æ¸²æŸ“å±‚å¯ä¼˜åŒ–E-Inkæ˜¾ç¤ºæ•ˆæœ
   - è¾ƒå¥½çš„åŠŸèƒ½å®Œæ•´æ€§å’Œå…¼å®¹æ€§

4. **æŒ‘æˆ˜**:
   - å¼€å‘å·¥ä½œé‡å¤§ï¼Œéœ€è¦å®ç°å®Œæ•´çš„æ¸²æŸ“ç®¡é“
   - å¹³å°ç§»æ¤å¯èƒ½é‡åˆ°å…¼å®¹æ€§é—®é¢˜

##### æ–¹æ¡ˆäºŒï¼šLightpanda + è¿œç¨‹æ¸²æŸ“

1. **æ¶æ„è®¾è®¡**:
   ```
   reMarkable(å®¢æˆ·ç«¯) â†’ ç½‘ç»œè¯·æ±‚ â†’ è¿œç¨‹LightpandaæœåŠ¡ â†’ æ¸²æŸ“ç»“æœ â†’ reMarkableæ˜¾ç¤º
   ```

2. **å®ç°æ­¥éª¤**:
   - åœ¨è¿œç¨‹æœåŠ¡å™¨è¿è¡ŒLightpanda
   - å®ç°è½»é‡çº§å®¢æˆ·ç«¯ï¼Œè´Ÿè´£ç½‘ç»œé€šä¿¡å’Œæ˜¾ç¤º
   - è®¾è®¡é«˜æ•ˆçš„æ¸²æŸ“ç»“æœä¼ è¾“åè®®
   - å¤„ç†ç¦»çº¿é˜…è¯»å’Œç¼“å­˜æœºåˆ¶

3. **ä¼˜åŠ¿**:
   - å‡å°‘reMarkableè®¾å¤‡çš„è®¡ç®—è´Ÿæ‹…
   - é¿å…å¹³å°ç§»æ¤é—®é¢˜
   - å¯åˆ©ç”¨äº‘ç«¯èµ„æºä¼˜åŒ–æ¸²æŸ“æ€§èƒ½

4. **æŒ‘æˆ˜**:
   - éœ€è¦ç½‘ç»œè¿æ¥ï¼Œå½±å“ç¦»çº¿ä½¿ç”¨
   - å¯èƒ½å¢åŠ å»¶è¿Ÿ
   - éœ€è¦å¤„ç†æ•°æ®å®‰å…¨å’Œéšç§é—®é¢˜

#### å®æ–½å»ºè®®

1. **å¯è¡Œæ€§è¯„ä¼°**:
   - æµ‹è¯•Lightpandaå¯¹å¾®ä¿¡è¯»ä¹¦ç½‘é¡µç‰ˆçš„å…¼å®¹æ€§
   - è¯„ä¼°ARMæ¶æ„ç§»æ¤çš„å·¥ä½œé‡
   - åˆ†ææ€§èƒ½æå‡æ˜¯å¦å€¼å¾—å¼€å‘æŠ•å…¥

2. **æ¸è¿›å¼é›†æˆ**:
   - å…ˆåœ¨æ ‡å‡†å¹³å°å®ç°æ¦‚å¿µéªŒè¯
   - é€æ­¥è§£å†³å¹³å°å…¼å®¹æ€§é—®é¢˜
   - ä¼˜åŒ–æ¸²æŸ“ç®¡é“å’Œæ˜¾ç¤ºæ•ˆæœ

3. **æ··åˆæ–¹æ¡ˆè€ƒè™‘**:
   - ç»“åˆLightpandaçš„JavaScriptæ”¯æŒå’ŒNetSurfçš„æ¸²æŸ“èƒ½åŠ›
   - é’ˆå¯¹ä¸åŒåœºæ™¯ä½¿ç”¨æœ€é€‚åˆçš„å¼•æ“
   - å®ç°æ— ç¼åˆ‡æ¢æœºåˆ¶

#### ç»“è®º

Lightpandaæ˜¯ä¸€ä¸ªéå¸¸æœ‰å‰æ™¯çš„æµè§ˆå™¨å¼•æ“ï¼Œå…¶æ€§èƒ½ä¼˜åŠ¿å’ŒJavaScriptæ”¯æŒå¯¹å¾®ä¿¡è¯»ä¹¦reMarkableé¡¹ç›®å…·æœ‰é‡è¦ä»·å€¼ã€‚ç‰¹åˆ«æ˜¯å…¶ä½å†…å­˜å ç”¨å’Œå¿«é€Ÿæ‰§è¡Œç‰¹æ€§ï¼Œéå¸¸é€‚åˆreMarkableè®¾å¤‡çš„èµ„æºå—é™ç¯å¢ƒã€‚

ç„¶è€Œï¼ŒLightpandaç›®å‰çš„æ— å¤´æ¨¡å¼ç‰¹æ€§å’Œå¹³å°å…¼å®¹æ€§é—®é¢˜éœ€è¦ä»”ç»†è¯„ä¼°ã€‚æ¨èé‡‡ç”¨**æ–¹æ¡ˆä¸€ï¼šLightpanda + è‡ªå®šä¹‰æ¸²æŸ“å±‚**ï¼Œé€šè¿‡å¼€å‘é€‚åˆE-Inkæ˜¾ç¤ºçš„æ¸²æŸ“å±‚ï¼Œå°†Lightpandaçš„æ€§èƒ½ä¼˜åŠ¿ä¸reMarkableçš„æ˜¾ç¤ºç‰¹æ€§ç»“åˆã€‚

è¿™ç§æ–¹æ¡ˆæ—¢è§£å†³äº†NetSurfçš„JavaScriptæ”¯æŒé—®é¢˜ï¼Œåˆèƒ½å……åˆ†åˆ©ç”¨Lightpandaçš„æ€§èƒ½ä¼˜åŠ¿ï¼Œæ˜¯å®ç°å¾®ä¿¡è¯»ä¹¦é˜…è¯»åŠŸèƒ½(åŒ…æ‹¬æ”¶è´¹ç« èŠ‚)çš„æœ‰åŠ›å€™é€‰æ–¹æ¡ˆã€‚

## é™„å½•C: æ•…éšœæ’é™¤æŒ‡å—

### C.1 å¸¸è§é—®é¢˜åŠè§£å†³æ–¹æ¡ˆ

1. **NetSurfå¯åŠ¨å¤±è´¥**
   - æ£€æŸ¥åº“æ–‡ä»¶æ˜¯å¦å®Œæ•´: `ldd /opt/bin/netsurf`
   - ç¡®è®¤å­—ä½“æ–‡ä»¶è·¯å¾„æ­£ç¡®
   - æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•

2. **ä¸­æ–‡æ˜¾ç¤ºé—®é¢˜**
   - ç¡®è®¤ä¸­æ–‡å­—ä½“å·²å®‰è£…
   - æ£€æŸ¥å­—ä½“é…ç½®è·¯å¾„
   - å°è¯•å…¶ä»–ä¸­æ–‡å­—ä½“

3. **ç½‘ç»œè¿æ¥é—®é¢˜**
   - æ£€æŸ¥WiFiè¿æ¥çŠ¶æ€
   - ç¡®è®¤DNSè®¾ç½®æ­£ç¡®
   - å°è¯•ç›´æ¥IPè®¿é—®

4. **æ€§èƒ½é—®é¢˜**
   - è°ƒæ•´ç¼©æ”¾æ¯”ä¾‹
   - ç¦ç”¨å›¾ç‰‡åŠ è½½
   - æ¸…ç†ç¼“å­˜æ–‡ä»¶

### C.2 è°ƒè¯•æŠ€å·§

1. **å¯ç”¨è°ƒè¯•æ¨¡å¼**
   ```bash
   export NETSURF_DEBUG=1
   /opt/bin/netsurf -v
   ```

2. **æŸ¥çœ‹æ—¥å¿—**
   ```bash
   # æŸ¥çœ‹ç³»ç»Ÿæ—¥å¿—
   journalctl -f
   # æŸ¥çœ‹NetSurfæ—¥å¿—
   tail -f ~/.netsurf/log
   ```

3. **å†…å­˜ä½¿ç”¨ç›‘æ§**
   ```bash
   # ç›‘æ§å†…å­˜ä½¿ç”¨
   watch -n 1 'free -h; ps aux | grep netsurf'
   ```

---

*æœ¬æ–‡æ¡£å°†æŒç»­æ›´æ–°ï¼Œè®°å½•é¡¹ç›®è¿›å±•å’ŒæŠ€æœ¯å‘ç°ã€‚*
